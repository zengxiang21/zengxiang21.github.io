<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>Nodejs | zx的博客</title><meta name="keywords" content="博客,zx"><meta name="author" content="zengxiang"><meta name="copyright" content="zengxiang"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="Node.js 第1天上午总结 Node.js 是什么   Node.js ois JavaScript runtime built on Chrome’s V8 javascript engine  Chrome V8公认解析的js最快的，将引擎移植过来开发了一个独立的js开发环境   JavaScript 运行时环境  既不是语言，也不是框架，它是一个平台  以前只有浏览器可以解析执行Java">
<meta property="og:type" content="article">
<meta property="og:title" content="Nodejs">
<meta property="og:url" content="https://zengxiang21.github.io/2022/01/11/node/index.html">
<meta property="og:site_name" content="zx的博客">
<meta property="og:description" content="Node.js 第1天上午总结 Node.js 是什么   Node.js ois JavaScript runtime built on Chrome’s V8 javascript engine  Chrome V8公认解析的js最快的，将引擎移植过来开发了一个独立的js开发环境   JavaScript 运行时环境  既不是语言，也不是框架，它是一个平台  以前只有浏览器可以解析执行Java">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://picsum.photos/id/369/4692/3128">
<meta property="article:published_time" content="2022-01-11T12:42:19.228Z">
<meta property="article:modified_time" content="2022-01-12T00:21:35.000Z">
<meta property="article:author" content="zengxiang">
<meta property="article:tag" content="博客,zx">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://picsum.photos/id/369/4692/3128"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://zengxiang21.github.io/2022/01/11/node/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isanchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Nodejs',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2022-01-12 08:21:35'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="/atom.xml" title="zx的博客" type="application/atom+xml">
</head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/./img/avatar.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data is-center"><div class="data-item"><a href="/archives/"><div class="headline">文章</div><div class="length-num">11</div></a></div><div class="data-item"><a href="/tags/"><div class="headline">标签</div><div class="length-num">0</div></a></div><div class="data-item"><a href="/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 音视频</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> Music</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> Movie</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 链接</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://picsum.photos/id/369/4692/3128')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">zx的博客</a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 音视频</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> Music</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> Movie</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 链接</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">Nodejs</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2022-01-11T12:42:19.228Z" title="发表于 2022-01-11 20:42:19">2022-01-11</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2022-01-12T00:21:35.000Z" title="更新于 2022-01-12 08:21:35">2022-01-12</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="Nodejs"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="Node-js-第1天"><a href="#Node-js-第1天" class="headerlink" title="Node.js 第1天"></a>Node.js 第1天</h1><h2 id="上午总结"><a href="#上午总结" class="headerlink" title="上午总结"></a>上午总结</h2><ul>
<li><p>Node.js 是什么 </p>
<ul>
<li><p>Node.js ois JavaScript runtime built on Chrome’s V8 javascript engine</p>
<ul>
<li>Chrome V8公认解析的js最快的，将引擎移植过来开发了一个独立的js开发环境</li>
</ul>
</li>
<li><p>JavaScript 运行时环境</p>
</li>
<li><p>既不是语言，也不是框架，它是一个平台</p>
</li>
<li><p>以前只有浏览器可以解析执行Javascript代码，现在可以脱离浏览器运行，归功于Node.js</p>
</li>
</ul>
</li>
<li><p>Node.js 中的 JavaScript</p>
<ul>
<li><strong>没有 BOM、DOM</strong></li>
<li>EcmaScript 基本的 JavaScript 语言部分</li>
<li>在 Node 中为 JavaScript 提供了一些服务器级别的 API<ul>
<li>文件操作的能力</li>
<li>http 服务的能力</li>
</ul>
</li>
</ul>
</li>
<li><p>Node.js特性</p>
<ul>
<li>事件驱动event-driven</li>
<li>非阻塞IO模型(异步) non-blocking I/O model</li>
<li>轻量高效 lightweight and efficient</li>
</ul>
</li>
<li><p>Node.js最大的安装包生态系统npm</p>
<ul>
<li>npm是世界上最大的开源库生态系统</li>
<li>绝大多数javascript安装包都在npm上</li>
<li>npm install jquery</li>
</ul>
</li>
<li><p>Node.js能做什么？</p>
<ul>
<li><strong>Web服务器后台</strong></li>
<li><strong>命令行工具</strong><ul>
<li>npm</li>
<li>git(c语言)</li>
<li>hexo(node)</li>
</ul>
</li>
</ul>
</li>
<li><p>学习到的东西</p>
<ul>
<li><p>B/S编程模型</p>
</li>
<li><p>模块化编程</p>
<ul>
<li>以前js只能通过加载script标签来加载</li>
<li>Node可以向@import()一样来引用加载javascript脚本文件</li>
</ul>
</li>
<li><p>Node常用API</p>
</li>
<li><p>异步编程</p>
<ul>
<li>Promise</li>
<li>async</li>
<li>generator</li>
</ul>
</li>
<li><p>Express开发框架</p>
</li>
<li><p>Ecmascript6</p>
</li>
</ul>
</li>
</ul>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><ul>
<li><p>Node 中的 JavaScript</p>
<ul>
<li><p>EcmaScript</p>
<ul>
<li>变量</li>
<li>方法</li>
<li>数据类型</li>
<li>内置对象</li>
<li>Array</li>
<li>Object</li>
<li>Date</li>
<li>Math</li>
</ul>
</li>
<li><p>模块系统</p>
<ul>
<li>在 Node 中没有全局作用域的概念</li>
<li>在 Node 中，只能通过 require 方法来加载执行多个 JavaScript 脚本文件</li>
<li>require 加载只能是执行其中的代码，文件与文件之间由于是模块作用域，所以不会有污染的问题<ul>
<li>模块完全是封闭的</li>
<li>外部无法访问内部</li>
<li>内部也无法访问外部</li>
</ul>
</li>
<li>模块作用域固然带来了一些好处，可以加载执行多个文件，可以完全避免变量命名冲突污染的问题</li>
<li>但是某些情况下，模块与模块是需要进行通信的</li>
<li>在每个模块中，都提供了一个对象：<code>exports</code></li>
<li>该对象默认是一个空对象</li>
<li>你要做的就是把需要被外部访问使用的成员手动的挂载到 <code>exports</code> 接口对象中</li>
<li>然后谁来 <code>require</code> 这个模块，谁就可以得到模块内部的 <code>exports</code> 接口对象</li>
<li>还有其它的一些规则，具体后面讲，以及如何在项目中去使用这种编程方式，会通过后面的案例来处理</li>
</ul>
</li>
<li><p>核心模块</p>
<ul>
<li>核心模块是由 Node 提供的一个个的具名的模块，服务器级别的API，它们都有自己特殊的名称标识，例如<ul>
<li>fs 文件操作模块</li>
<li>http 网络服务构建模块</li>
<li>os 操作系统信息模块</li>
<li>path 路径处理模块</li>
<li>。。。。</li>
</ul>
</li>
<li>所有核心模块在使用的时候都必须手动的先使用 <code>require</code> 方法来加载，然后才可以使用，例如：<ul>
<li>fs是file system，fs核心模块提供了所有文件操作相关的API</li>
<li><code>var fs = require(&#39;fs&#39;)</code></li>
<li><code>fs.readFile(&#39;path&#39;,function()&#123;&#125;)</code><ul>
<li>返回值两个error和data</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><p>http</p>
<p>require</p>
<p>端口号</p>
<ul>
<li>ip 地址定位计算机</li>
<li>端口号定位具体的应用程序</li>
</ul>
<p>Content-Type</p>
<ul>
<li>服务器最好把每次响应的数据是什么内容类型都告诉客户端，而且要正确的告诉</li>
<li>不同的资源对应的 Content-Type 是不一样，具体参照：<a target="_blank" rel="noopener" href="http://tool.oschina.net/commons">http://tool.oschina.net/commons</a></li>
<li>对于文本类型的数据，最好都加上编码，目的是为了防止中文解析乱码问题</li>
</ul>
<p>通过网络发送文件</p>
<ul>
<li>发送的并不是文件，本质上来讲发送是文件的内容</li>
<li>当浏览器收到服务器响应内容之后，就会根据你的 Content-Type 进行对应的解析处理</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">var http=require(&#x27;http&#x27;);</span><br><span class="line">var server=http.createServer();</span><br><span class="line">server.on(&#x27;request&#x27;, function(request,response) &#123;</span><br><span class="line">    console.log(&#x27;收到请求&#x27;);</span><br><span class="line">    response.write(&#x27;结束&#x27;);</span><br><span class="line">    response.end();</span><br><span class="line">&#125;)</span><br><span class="line">server.listen(3000,function()&#123;</span><br><span class="line">	console.log(&#x27;服务器启动成功&#x27;);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> http=<span class="built_in">require</span>(<span class="string">&#x27;http&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> fs=<span class="built_in">require</span>(<span class="string">&#x27;fs&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> server=http.createServer();</span><br><span class="line">server.on(<span class="string">&#x27;request&#x27;</span>, <span class="function"><span class="keyword">function</span>(<span class="params">req,res</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;收到请求&#x27;</span>);</span><br><span class="line">    fs.readFile(<span class="string">&#x27;./index.html&#x27;</span>, <span class="function"><span class="keyword">function</span>(<span class="params">err,data</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(err)&#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">&#x27;读取失败&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            res.setHeader(<span class="string">&#x27;Content-Type&#x27;</span>, <span class="string">&#x27;text/html;charset=utf-8&#x27;</span>);</span><br><span class="line">            res.end(data);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;)</span><br><span class="line">server.listen(<span class="number">3000</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">	<span class="built_in">console</span>.log(<span class="string">&#x27;服务器启动成功&#x27;</span>);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></li>
<li><p>模块系统</p>
</li>
<li><p>Node 中的其它的核心模块</p>
</li>
<li><p>做一个小管理系统：</p>
<ul>
<li>CRUD</li>
</ul>
</li>
<li><p>Express Web 开发框架</p>
<ul>
<li><code>npm install express</code></li>
</ul>
</li>
</ul>
<h1 id="Node-js-第2天课堂笔记"><a href="#Node-js-第2天课堂笔记" class="headerlink" title="Node.js 第2天课堂笔记"></a>Node.js 第2天课堂笔记</h1><h2 id="知识点"><a href="#知识点" class="headerlink" title="知识点"></a>知识点</h2><h2 id="反馈"><a href="#反馈" class="headerlink" title="反馈"></a>反馈</h2><ul>
<li>老师像我一同学 但我知道 我同学没这么牛逼。。。<ul>
<li>学习、分享、交流</li>
</ul>
</li>
<li>老师 讲讲sumblie需要安装哪些插件把 以及怎么用Md结尾的文档，对于我们来说好像就是一个阅读器一样使用………………<ul>
<li>HTML 也是标记语言</li>
<li>markdown 标记语言</li>
<li><code>#</code> 就是标题</li>
<li><code>-</code>、<code>*</code> 就是列表</li>
<li><code>**加粗内容**</code></li>
<li><code>GFM</code></li>
</ul>
</li>
<li>第一天上课 给我感觉挺好的 就是老师可能对早下课是不是有什么误解 我们平时都是 五点半放学的 ，还有就是有点啰嗦，那个不能起a呀b呀我感觉听了不下 五遍 我都要被你笑哭了</li>
<li>老师讲的挺好的</li>
<li>后来讲的速度有点上来了！</li>
<li>老师很耐心！</li>
<li>老师讲的课很好！</li>
<li>感觉老师讲的有点快，语速快</li>
<li>没有对比就没有伤害 体验了一把 普通话标准 英语发音又标准 幸福感</li>
<li>感觉老师讲课的风格简单利落，思路清晰。 nice</li>
<li>结尾不写分号是老师写的es6的代码风格，还是老师懒得写？</li>
</ul>
<h3 id="代码风格"><a href="#代码风格" class="headerlink" title="代码风格"></a>代码风格</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> foo = <span class="string">&#x27;bar&#x27;</span></span><br><span class="line"><span class="keyword">var</span> foo =<span class="string">&#x27;bar&#x27;</span></span><br><span class="line"><span class="keyword">var</span> foo= <span class="string">&#x27;bar&#x27;</span></span><br><span class="line"><span class="keyword">var</span> foo = <span class="string">&quot;bar&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&#x27;hello&#x27;</span>) </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;hello&#x27;</span>) </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="literal">true</span> )&#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">&#x27;hello&#x27;</span>) </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>为了约定大家的代码风格，所以在社区中诞生了一些比较规范的代码风格规范：dnsajkndkjsabnjkdnjksandjknsajkdnjkasnjkdnjksandjknsajkdnjksajkdnas</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://standardjs.com/">JavaScript Standard Style</a></li>
<li>Airbnb JavaScript Style</li>
</ul>
<h2 id="复习"><a href="#复习" class="headerlink" title="复习"></a>复习</h2><h2 id="上午总结-1"><a href="#上午总结-1" class="headerlink" title="上午总结"></a>上午总结</h2><ul>
<li><p>代码风格</p>
</li>
<li><p>无分号</p>
<ul>
<li><code>(</code></li>
<li><code>[</code></li>
<li>`</li>
<li>最好前面补分号，避免一些问题</li>
<li>《编写可维护的 JavaScript》</li>
<li>不仅是功能，还要写的漂亮</li>
</ul>
</li>
<li><p>服务端渲染</p>
<ul>
<li>说白了就是在服务端使用模板引擎</li>
<li>模板引擎最早诞生于服务端，后来才发展到了前端</li>
</ul>
</li>
<li><p>服务端渲染和客户端渲染的区别</p>
<ul>
<li>客户端渲染不利于 SEO 搜索引擎优化</li>
<li>服务端渲染是可以被爬虫抓取到的，客户端异步渲染是很难被爬虫抓取到的</li>
<li>所以你会发现真正的网站既不是纯异步也不是纯服务端渲染出来的</li>
<li>而是两者结合来做的</li>
<li>例如京东的商品列表就采用的是服务端渲染，目的了为了 SEO 搜索引擎优化</li>
<li>而它的商品评论列表为了用户体验，而且也不需要 SEO 优化，所以采用是客户端渲染</li>
</ul>
</li>
</ul>
<h2 id="下午总结"><a href="#下午总结" class="headerlink" title="下午总结"></a>下午总结</h2><h3 id="在Node中使用模板引擎"><a href="#在Node中使用模板引擎" class="headerlink" title="在Node中使用模板引擎"></a>在Node中使用模板引擎</h3><ul>
<li><p>安装模板引擎</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ npm install art-template --save</span><br></pre></td></tr></table></figure></li>
<li><p>引入</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> template = <span class="built_in">require</span>(<span class="string">&#x27;art-template&#x27;</span>);</span><br></pre></td></tr></table></figure></li>
<li><p>核心方法</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 基于模板名渲染模板</span></span><br><span class="line">template(filename, data);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 将模板源代码编译成函数</span></span><br><span class="line">template.compile(source, options);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 将模板源代码编译成函数并立刻执行</span></span><br><span class="line">template.render(source, data, options);</span><br><span class="line">编译并返回渲染结果。</span><br><span class="line">    参数：</span><br><span class="line">    &#123;string&#125; source</span><br><span class="line">    &#123;<span class="built_in">Object</span>&#125; options</span><br><span class="line">    返回值：&#123;string&#125;</span><br><span class="line"><span class="keyword">var</span> html = template.render(<span class="string">&#x27;hi, &lt;%=value%&gt;.&#x27;</span>, &#123;<span class="attr">value</span>: <span class="string">&#x27;aui&#x27;</span>&#125;);</span><br></pre></td></tr></table></figure></li>
<li><p>模板引擎用法</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;IE=edge&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&#x27;./template-web.js&#x27;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&#x27;text/html&#x27;</span> <span class="attr">id</span>=<span class="string">&#x27;tpl&#x27;</span>&gt;</span><span class="handlebars"><span class="xml"></span></span></span><br><span class="line"><span class="xml"><span class="handlebars">        大家好，我叫</span><span class="template-variable">&#123;&#123;<span class="name">name</span>&#125;&#125;</span><span class="xml">;</span></span></span><br><span class="line"><span class="xml"><span class="handlebars">        我的爱好是:</span><span class="template-variable">&#123;&#123;<span class="name"><span class="builtin-name">each</span></span> hobbies&#125;&#125;</span><span class="template-variable">&#123;&#123;<span class="name">$value</span>&#125;&#125;</span><span class="template-tag">&#123;&#123;/<span class="name"><span class="builtin-name">each</span></span>&#125;&#125;</span><span class="xml">;</span></span></span><br><span class="line"><span class="xml"><span class="handlebars">    </span></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> ret = template(<span class="string">&#x27;tpl&#x27;</span>, &#123;</span></span><br><span class="line"><span class="javascript">            <span class="attr">name</span>: <span class="string">&#x27;zx&#x27;</span>,</span></span><br><span class="line"><span class="javascript">            <span class="attr">hobbies</span>: [<span class="string">&#x27;唱歌&#x27;</span>, <span class="string">&#x27;跳舞&#x27;</span>]</span></span><br><span class="line"><span class="javascript">        &#125;);</span></span><br><span class="line"><span class="javascript">        <span class="built_in">console</span>.log(ret);</span></span><br><span class="line"><span class="javascript">        <span class="built_in">console</span>.log(<span class="keyword">typeof</span> ret);</span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> s = <span class="built_in">JSON</span>.parse(ret);</span></span><br><span class="line"><span class="javascript">        <span class="built_in">console</span>.log(s);</span></span><br><span class="line"><span class="javascript">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li><p>nodejs模板引擎用法</p>
<ul>
<li>index.html</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;IE=edge&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h2</span>&gt;</span>你好我叫&#123;&#123;name&#125;&#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h3</span>&gt;</span>我今年&#123;&#123;age&#125;&#125;<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>js</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> template=<span class="built_in">require</span>(<span class="string">&#x27;art-template&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> file=<span class="built_in">require</span>(<span class="string">&#x27;fs&#x27;</span>);</span><br><span class="line">file.readFile(<span class="string">&#x27;./index.html&#x27;</span>, <span class="function"><span class="keyword">function</span>(<span class="params">err,data</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> ret=template.render(data.toString(),&#123;</span><br><span class="line">        <span class="attr">name</span>: <span class="string">&#x27;zx&#x27;</span>,</span><br><span class="line">        <span class="attr">age</span>:<span class="string">&#x27;22&#x27;</span></span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="built_in">console</span>.log(ret);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h3 id="提交表单"><a href="#提交表单" class="headerlink" title="提交表单"></a>提交表单</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// app application 应用程序</span></span><br><span class="line"><span class="comment">// 把当前模块所有的依赖项都声明再文件模块最上面</span></span><br><span class="line"><span class="comment">// 为了让目录结构保持统一清晰，所以我们约定，把所有的 HTML 文件都放到 views（视图） 目录中</span></span><br><span class="line"><span class="comment">// 我们为了方便的统一处理这些静态资源，所以我们约定把所有的静态资源都存放在 public 目录中</span></span><br><span class="line"><span class="comment">// 哪些资源能被用户访问，哪些资源不能被用户访问，我现在可以通过代码来进行非常灵活的控制</span></span><br><span class="line"><span class="comment">// / index.html</span></span><br><span class="line"><span class="comment">// /public 整个 public 目录中的资源都允许被访问</span></span><br><span class="line"><span class="comment">// 前后端融会贯通了，为所欲为</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> http = <span class="built_in">require</span>(<span class="string">&#x27;http&#x27;</span>)</span><br><span class="line"><span class="keyword">var</span> fs = <span class="built_in">require</span>(<span class="string">&#x27;fs&#x27;</span>)</span><br><span class="line"><span class="keyword">var</span> url = <span class="built_in">require</span>(<span class="string">&#x27;url&#x27;</span>)</span><br><span class="line"><span class="keyword">var</span> template = <span class="built_in">require</span>(<span class="string">&#x27;art-template&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> comments = [</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;张三&#x27;</span>,</span><br><span class="line">    <span class="attr">message</span>: <span class="string">&#x27;今天天气不错！&#x27;</span>,</span><br><span class="line">    <span class="attr">dateTime</span>: <span class="string">&#x27;2015-10-16&#x27;</span></span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;张三2&#x27;</span>,</span><br><span class="line">    <span class="attr">message</span>: <span class="string">&#x27;今天天气不错！&#x27;</span>,</span><br><span class="line">    <span class="attr">dateTime</span>: <span class="string">&#x27;2015-10-16&#x27;</span></span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;张三3&#x27;</span>,</span><br><span class="line">    <span class="attr">message</span>: <span class="string">&#x27;今天天气不错！&#x27;</span>,</span><br><span class="line">    <span class="attr">dateTime</span>: <span class="string">&#x27;2015-10-16&#x27;</span></span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;张三4&#x27;</span>,</span><br><span class="line">    <span class="attr">message</span>: <span class="string">&#x27;今天天气不错！&#x27;</span>,</span><br><span class="line">    <span class="attr">dateTime</span>: <span class="string">&#x27;2015-10-16&#x27;</span></span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;张三5&#x27;</span>,</span><br><span class="line">    <span class="attr">message</span>: <span class="string">&#x27;今天天气不错！&#x27;</span>,</span><br><span class="line">    <span class="attr">dateTime</span>: <span class="string">&#x27;2015-10-16&#x27;</span></span><br><span class="line">  &#125;</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="comment">// /pinglun?name=的撒的撒&amp;message=的撒的撒的撒</span></span><br><span class="line"><span class="comment">// 对于这种表单提交的请求路径，由于其中具有用户动态填写的内容</span></span><br><span class="line"><span class="comment">// 所以你不可能通过去判断完整的 url 路径来处理这个请求</span></span><br><span class="line"><span class="comment">// </span></span><br><span class="line"><span class="comment">// 结论：对于我们来讲，其实只需要判定，如果你的请求路径是 /pinglun 的时候，那我就认为你提交表单的请求过来了</span></span><br><span class="line"></span><br><span class="line">http</span><br><span class="line">  .createServer(<span class="function"><span class="keyword">function</span> (<span class="params">req, res</span>) </span>&#123; <span class="comment">// 简写方式，该函数会直接被注册为 server 的 request 请求事件处理函数</span></span><br><span class="line">    <span class="comment">// 使用 url.parse 方法将路径解析为一个方便操作的对象，第二个参数为 true 表示直接将查询字符串转为一个对象（通过 query 属性来访问）</span></span><br><span class="line">    <span class="keyword">var</span> parseObj = url.parse(req.url, <span class="literal">true</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 单独获取不包含查询字符串的路径部分（该路径不包含 ? 之后的内容）</span></span><br><span class="line">    <span class="keyword">var</span> pathname = parseObj.pathname</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (pathname === <span class="string">&#x27;/&#x27;</span>) &#123;</span><br><span class="line">      fs.readFile(<span class="string">&#x27;./views/index.html&#x27;</span>, <span class="function"><span class="keyword">function</span> (<span class="params">err, data</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (err) &#123;</span><br><span class="line">          <span class="keyword">return</span> res.end(<span class="string">&#x27;404 Not Found.&#x27;</span>)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">var</span> htmlStr = template.render(data.toString(), &#123;</span><br><span class="line">          <span class="attr">comments</span>: comments</span><br><span class="line">        &#125;)</span><br><span class="line">        res.end(htmlStr)</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (pathname === <span class="string">&#x27;/post&#x27;</span>) &#123;</span><br><span class="line">      <span class="comment">// 其它的都处理成 404 找不到</span></span><br><span class="line">      fs.readFile(<span class="string">&#x27;./views/post.html&#x27;</span>, <span class="function"><span class="keyword">function</span> (<span class="params">err, data</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (err) &#123;</span><br><span class="line">          <span class="keyword">return</span> res.end(<span class="string">&#x27;404 Not Found.&#x27;</span>)</span><br><span class="line">        &#125;</span><br><span class="line">        res.end(data)</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (pathname.indexOf(<span class="string">&#x27;/public/&#x27;</span>) === <span class="number">0</span>) &#123;</span><br><span class="line">      <span class="comment">// /public/css/main.css</span></span><br><span class="line">      <span class="comment">// /public/js/main.js</span></span><br><span class="line">      <span class="comment">// /public/lib/jquery.js</span></span><br><span class="line">      <span class="comment">// 统一处理：</span></span><br><span class="line">      <span class="comment">//    如果请求路径是以 /public/ 开头的，则我认为你要获取 public 中的某个资源</span></span><br><span class="line">      <span class="comment">//    所以我们就直接可以把请求路径当作文件路径来直接进行读取</span></span><br><span class="line">      fs.readFile(<span class="string">&#x27;.&#x27;</span> + pathname, <span class="function"><span class="keyword">function</span> (<span class="params">err, data</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (err) &#123;</span><br><span class="line">          <span class="keyword">return</span> res.end(<span class="string">&#x27;404 Not Found.&#x27;</span>)</span><br><span class="line">        &#125;</span><br><span class="line">        res.end(data)</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (pathname === <span class="string">&#x27;/pinglun&#x27;</span>) &#123;</span><br><span class="line">      <span class="comment">// 注意：这个时候无论 /pinglun?xxx 之后是什么，我都不用担心了，因为我的 pathname 是不包含 ? 之后的那个路径</span></span><br><span class="line">      <span class="comment">// 一次请求对应一次响应，响应结束这次请求也就结束了</span></span><br><span class="line">      <span class="comment">// res.end(JSON.stringify(parseObj.query))</span></span><br><span class="line"></span><br><span class="line">      <span class="comment">// 我们已经使用 url 模块的 parse 方法把请求路径中的查询字符串给解析成一个对象了</span></span><br><span class="line">      <span class="comment">// 所以接下来要做的就是：</span></span><br><span class="line">      <span class="comment">//    1. 获取表单提交的数据 parseObj.query</span></span><br><span class="line">      <span class="comment">//    2. 将当前时间日期添加到数据对象中，然后存储到数组中</span></span><br><span class="line">      <span class="comment">//    3. 让用户重定向跳转到首页 /</span></span><br><span class="line">      <span class="comment">//       当用户重新请求 / 的时候，我数组中的数据已经发生变化了，所以用户看到的页面也就变了</span></span><br><span class="line">      <span class="keyword">var</span> comment = parseObj.query</span><br><span class="line">      comment.dateTime = <span class="string">&#x27;2017-11-2 17:11:22&#x27;</span></span><br><span class="line">      comments.unshift(comment)</span><br><span class="line">      <span class="comment">// 服务端这个时候已经把数据存储好了，接下来就是让用户重新请求 / 首页，就可以看到最新的留言内容了</span></span><br><span class="line"></span><br><span class="line">      <span class="comment">// 如何通过服务器让客户端重定向？</span></span><br><span class="line">      <span class="comment">//    1. 状态码设置为 302 临时重定向</span></span><br><span class="line">      <span class="comment">//        statusCode</span></span><br><span class="line">      <span class="comment">//    2. 在响应头中通过 Location 告诉客户端往哪儿重定向</span></span><br><span class="line">      <span class="comment">//        setHeader</span></span><br><span class="line">      <span class="comment">// 如果客户端发现收到服务器的响应的状态码是 302 就会自动去响应头中找 Location ，然后对该地址发起新的请求</span></span><br><span class="line">      <span class="comment">// 所以你就能看到客户端自动跳转了</span></span><br><span class="line">      res.statusCode = <span class="number">302</span></span><br><span class="line">      res.setHeader(<span class="string">&#x27;Location&#x27;</span>, <span class="string">&#x27;/&#x27;</span>)</span><br><span class="line">      res.end()</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="comment">// 其它的都处理成 404 找不到</span></span><br><span class="line">      fs.readFile(<span class="string">&#x27;./views/404.html&#x27;</span>, <span class="function"><span class="keyword">function</span> (<span class="params">err, data</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (err) &#123;</span><br><span class="line">          <span class="keyword">return</span> res.end(<span class="string">&#x27;404 Not Found.&#x27;</span>)</span><br><span class="line">        &#125;</span><br><span class="line">        res.end(data)</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">  .listen(<span class="number">3000</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;running...&#x27;</span>)</span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// Node 不适合从来没有接触过服务端的人学习</span></span><br><span class="line"><span class="comment">// 如果想要真正的学号服务端，还是老牌的 Java、PHP 这些平台</span></span><br><span class="line"><span class="comment">// Node 不是特别适合入门服务端，但不代表 Node 不强大</span></span><br><span class="line"><span class="comment">// Node 很厉害，具有经验的人可以玩儿的非常的牛</span></span><br><span class="line"><span class="comment">// 不适合新手的原因就在于比较偏底层、而且太灵活</span></span><br><span class="line"><span class="comment">// Java、PHP 好入门的原因就在于：这些平台屏蔽了一些底层</span></span><br><span class="line"><span class="comment">// res.redirect(&#x27;重定向&#x27;)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 晚上写案例照着下面的步骤写：</span></span><br><span class="line"><span class="comment">// 1. / index.html</span></span><br><span class="line"><span class="comment">// 2. 开放 public 目录中的静态资源</span></span><br><span class="line"><span class="comment">//    当请求 /public/xxx 的时候，读取响应 public 目录中的具体资源</span></span><br><span class="line"><span class="comment">// 3. /post post.html</span></span><br><span class="line"><span class="comment">// 4. /pinglun</span></span><br><span class="line"><span class="comment">//    4.1 接收表单提交数据</span></span><br><span class="line"><span class="comment">//    4.2 存储表单提交的数据</span></span><br><span class="line"><span class="comment">//    4.3 让表单重定向到 /</span></span><br><span class="line"><span class="comment">//        statusCode</span></span><br><span class="line"><span class="comment">//        setHeader</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 明天：</span></span><br><span class="line"><span class="comment">// 模块系统</span></span><br><span class="line"><span class="comment">// Express（第三方 Web 开发框架）</span></span><br><span class="line"><span class="comment">//    这两做的事儿，在框架里面就是一个 API 的事儿</span></span><br><span class="line"><span class="comment">//    使用框架的目的就是让我们更加专注于业务，而不是底层细节</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="重定向"><a href="#重定向" class="headerlink" title="重定向"></a>重定向</h3><p><img src="https://s2.loli.net/2021/12/26/uyRl4HoVSzBtGIO.png" alt="img"></p>
</li>
</ul>
</li>
</ul>
<p><img src="https://s2.loli.net/2021/12/26/6vewpc1ZMlr7m2A.png" alt="img"></p>
<p><img src="https://s2.loli.net/2021/12/26/cbiHTGUquSZ5XLd.png" alt="img"></p>
<p><img src="https://s2.loli.net/2021/12/26/KyQaoeUA8YFTbES.png" alt="img"></p>
<h1 id="Node-js-第3天课堂笔记"><a href="#Node-js-第3天课堂笔记" class="headerlink" title="Node.js 第3天课堂笔记"></a>Node.js 第3天课堂笔记</h1><h2 id="知识点-1"><a href="#知识点-1" class="headerlink" title="知识点"></a>知识点</h2><ul>
<li><p>增删改查</p>
</li>
<li><p>登陆</p>
</li>
<li><p>注册</p>
</li>
<li><p>头像</p>
<ul>
<li>服务端图片</li>
<li>水印</li>
<li>图片水印</li>
</ul>
</li>
<li><p>找回密码</p>
</li>
<li><p>密码修改</p>
</li>
<li><p>模块系统</p>
<ul>
<li>核心模块</li>
<li>第三方模块</li>
<li>自己写的模块</li>
<li>加载规则以及加载机制</li>
<li>循环加载</li>
</ul>
</li>
<li><p>npm</p>
</li>
<li><p>package.json</p>
</li>
<li><p>Express</p>
<ul>
<li>第三方 Web 开发框架</li>
<li>高度封装了 http 模块</li>
<li>更加专注于业务，而非底层细节</li>
<li>知其所以然</li>
</ul>
</li>
<li><p>增删改查</p>
<ul>
<li>使用文件来保存数据（锻炼异步编码）</li>
</ul>
</li>
<li><p>MongoDB</p>
<ul>
<li>（所有方法都封装好了）</li>
</ul>
</li>
</ul>
<h2 id="反馈-1"><a href="#反馈-1" class="headerlink" title="反馈"></a>反馈</h2><ul>
<li>希望老师再推荐一些前端学习的书籍，谢谢！<ul>
<li> 《JavaScript 高级编程》第3班</li>
<li> 学习，解决问题</li>
<li> 书本可以更好的系统的整理学过的内容，了解一些细节</li>
<li> 《JavaScript 语言精粹》</li>
</ul>
</li>
<li>seo的资料，嘿嘿<ul>
<li>网站运营 SEO</li>
<li>SEO 运营专员</li>
<li>百度、Google、搜狗、</li>
</ul>
</li>
<li> 最后老师那个怎么做案例的步骤真的是很有用 觉得今天的反馈 大概又是夸老师的比较多 老师声音很有特点</li>
<li> 老师讲的很仔细,虽然语速有点快但是会重复很多遍,即使第一遍没听会第二遍第三遍也懂了.很好.</li>
<li> 使用markdown一次只能打开一个文件,不知道怎么建文件夹，是需要安插件吗?</li>
<li>老师，软件版本的升级是以什么作为理论支持的，为什么跳跃间隙可以这么大？还有，看上了老师的电子图书馆，瞬间好爱学习呀，真的！<ul>
<li> 软件开发版本里面涉及到软件工程学： </li>
<li>x.x.x<ul>
<li> 0.0.1</li>
<li> 0.0.2</li>
<li> 1.1.5</li>
<li> 1.9.2</li>
<li> 2（新增功能比较多，甚至可能去除了某些功能）.5(加入了新功能).0（修复bug，提升性能）</li>
<li> 大版本</li>
<li> 一般是这些客户端软件、技术框架开发者比较理解的多</li>
<li> 做网站很少涉及到版本的概念，网站的目的就是快</li>
</ul>
</li>
</ul>
</li>
<li> art-template里面用的语法是jQuery吗， each什么的 我晕了 each,forEach, 遍历的全混了</li>
<li> 每一次的复习贼重要 老师很不错 我喜欢</li>
<li>在以后的工作中 用到node.js的地方多吗？ 在留言本的案例中 点击发表留言跳转页面的路径是url路径 和之前写的页面跳转写的文件路径还是有点分不清。<ul>
<li>技多不压身</li>
<li>Node 对于前端来讲是进阶高级前端开发工程师必备的技能</li>
<li>屌丝最容易逆袭的职业</li>
<li>见得东西多了你就不怕了</li>
<li>为所欲为</li>
</ul>
</li>
<li> 老师讲的挺清晰的 可是第一节太困了 路径有点没转变过来</li>
<li>如果从a中调用b中的数据，又从b中调用a中的数据，执行a代码，为什么把b中的执行完后才会执行a，而不是在b调用a的时候a中的代码继续执行<ul>
<li>a 加载了 b<ul>
<li>执行 b 中的代码</li>
<li>同时得到 b 中导出的接口对象：exports</li>
<li>执行 b 的过程中发现 b 也在 require a</li>
<li>b 就会反过来执行 a</li>
<li>a 中又加载 b</li>
<li>b 又反过来加载 a</li>
<li>这就是循环加载</li>
<li>如果你一旦出现了这种情况，说明你的思路有问题。</li>
<li>jQuery.js （可能不可能出现 jQuery 依赖了 main）</li>
<li>main.js 依赖了 jQuery</li>
<li>这个问题是矛盾。</li>
</ul>
</li>
<li>b 中也加载了 a</li>
<li></li>
<li>网页中所有的路径其实都是 url 路径，不是文件路径</li>
</ul>
</li>
<li> 问题就是不知道问题是什么,写案例的时候似懂非懂</li>
<li> 感觉思维有点跟不上,</li>
</ul>
<h2 id="复习-1"><a href="#复习-1" class="headerlink" title="复习"></a>复习</h2><ul>
<li><p>网站开发模型</p>
<ul>
<li>黑盒子、哑巴</li>
<li>写代码让它变得更智能</li>
<li>按照你设计好的套路供用户使用</li>
</ul>
</li>
<li><p>在 Node 中使用 art-template 模板引擎</p>
<ul>
<li>安装</li>
<li>加载</li>
<li>template.render()</li>
</ul>
</li>
<li><p>客户端渲染和服务端渲染的区别</p>
<ul>
<li>最少两次请求，发起 ajax 在客户端使用模板引擎渲染</li>
<li>客户端拿到的就是服务端已经渲染好的</li>
</ul>
</li>
<li><p>处理留言本案例首页数据列表渲染展示</p>
</li>
<li><p>处理留言本案例发表留言功能</p>
<ul>
<li>路径</li>
<li>设计好的请求路径</li>
<li>$GET 直接或查询字符串数据</li>
<li>Node 中需要咱们自己动手来解析<ul>
<li>url.parse()</li>
</ul>
</li>
<li>/pinglun?name=jack&amp;message=hello</li>
<li>split(‘?’)</li>
<li>name=jack&amp;message=hello</li>
<li>split(‘&amp;’)</li>
<li>name=jack message=hello</li>
<li>forEach()</li>
<li>name=jack.split(‘=’)</li>
<li>0 key</li>
<li>1 value</li>
</ul>
</li>
<li><p>掌握如何解析请求路径中的查询字符串</p>
<ul>
<li>url.parse()</li>
</ul>
</li>
<li><p>如何在 Node 中实现服务器重定向</p>
<ul>
<li>header(‘location’)<ul>
<li>301 永久重定向 浏览器会记住<ul>
<li>a.com b.com</li>
<li>a 浏览器不会请求 a 了</li>
<li>直接去跳到 b 了</li>
</ul>
</li>
<li>302 临时重定向 浏览器不记忆<ul>
<li>a.com b.com</li>
<li>a.com 还会请求 a</li>
<li>a 告诉浏览器你往 b</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><p>Node 中的 Console（REPL）使用</p>
</li>
</ul>
<h2 id="上午总结-2"><a href="#上午总结-2" class="headerlink" title="上午总结"></a>上午总结</h2><ul>
<li>jQuery 的 each 和 原生的 JavaScript 方法 forEach<ul>
<li>EcmaScript 5 提供的<ul>
<li>不兼容 IE 8</li>
</ul>
</li>
<li>jQuery 的 each 由 jQuery 这个第三方库提供<ul>
<li>jQuery 2 以下的版本是兼容 IE 8 的</li>
<li>它的 each 方法主要用来遍历 jQuery 实例对象（伪数组）</li>
<li>同时它也可以作为低版本浏览器中 forEach 替代品</li>
<li>jQuery 的实例对象不能使用 forEach 方法，如果想要使用必须转为数组才可以使用</li>
<li><code>[].slice.call(jQuery实例对象)</code></li>
</ul>
</li>
</ul>
</li>
<li>模块中导出多个成员和导出单个成员</li>
<li>301 和 302 状态码区别<ul>
<li>301 永久重定向，浏览器会记住</li>
<li>302 临时重定向</li>
</ul>
</li>
<li>exports 和 module.exports 的区别<ul>
<li>每个模块中都有一个 module 对象</li>
<li>module 对象中有一个 exports 对象</li>
<li>我们可以把需要导出的成员都挂载到 module.exports 接口对象中</li>
<li>也就是：<code>moudle.exports.xxx = xxx</code> 的方式</li>
<li>但是每次都 <code>moudle.exports.xxx = xxx</code> 很麻烦，点儿的太多了</li>
<li>所以 Node 为了你方便，同时在每一个模块中都提供了一个成员叫：<code>exports</code></li>
<li><code>exports === module.exports</code> 结果为  <code>true</code>s</li>
<li>所以对于：<code>moudle.exports.xxx = xxx</code> 的方式 完全可以：<code>expots.xxx = xxx</code></li>
<li>当一个模块需要导出单个成员的时候，这个时候必须使用：<code>module.exports = xxx</code> 的方式</li>
<li>不要使用 <code>exports = xxx</code> 不管用</li>
<li>因为每个模块最终向外 <code>return</code> 的是 <code>module.exports</code></li>
<li>而 <code>exports</code> 只是 <code>module.exports</code> 的一个引用</li>
<li>所以即便你为 <code>exports = xx</code> 重新赋值，也不会影响 <code>module.exports</code></li>
<li>但是有一种赋值方式比较特殊：<code>exports = module.exports</code> 这个用来重新建立引用关系的</li>
<li>之所以让大家明白这个道理，是希望可以更灵活的去用它</li>
</ul>
</li>
<li>Node 是一个比肩 Java、PHP 的一个平台<ul>
<li>JavaScript 既能写前端也能写服务端</li>
</ul>
</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">moudle.exports = &#123;</span><br><span class="line">  <span class="attr">a</span>: <span class="number">123</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 重新建立 exports 和 module.exports 之间的引用关系</span></span><br><span class="line"><span class="built_in">exports</span> = <span class="built_in">module</span>.exports</span><br><span class="line"></span><br><span class="line"><span class="built_in">exports</span>.foo = <span class="string">&#x27;bar&#x27;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Array</span>.prototype.mySlice = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> start = <span class="number">0</span></span><br><span class="line">  <span class="keyword">var</span> end = <span class="built_in">this</span>.length</span><br><span class="line">  <span class="keyword">if</span> (<span class="built_in">arguments</span>.length === <span class="number">1</span>) &#123;</span><br><span class="line">    start = <span class="built_in">arguments</span>[<span class="number">0</span>]</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="built_in">arguments</span>.length === <span class="number">2</span>) &#123;</span><br><span class="line">    start = <span class="built_in">arguments</span>[<span class="number">0</span>]</span><br><span class="line">    end = <span class="built_in">arguments</span>[<span class="number">1</span>]</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">var</span> tmp = []</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> i = start; i &lt; end; i++) &#123;</span><br><span class="line">    <span class="comment">// fakeArr[0]</span></span><br><span class="line">    <span class="comment">// fakeArr[1]</span></span><br><span class="line">    <span class="comment">// fakeArr[2]</span></span><br><span class="line">    tmp.push(<span class="built_in">this</span>[i])</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> tmp</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> fakeArr = &#123;</span><br><span class="line">  <span class="number">0</span>: <span class="string">&#x27;abc&#x27;</span>,</span><br><span class="line">  <span class="number">1</span>: <span class="string">&#x27;efg&#x27;</span>,</span><br><span class="line">  <span class="number">2</span>: <span class="string">&#x27;haha&#x27;</span>,</span><br><span class="line">  <span class="attr">length</span>: <span class="number">3</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 所以你就得到了真正的数组。 </span></span><br><span class="line">[].mySlice.call(fakeArr)</span><br></pre></td></tr></table></figure>

<h2 id="下午总结-1"><a href="#下午总结-1" class="headerlink" title="下午总结"></a>下午总结</h2><ul>
<li><p>jQuery 的 each 和 原生的 JavaScript 方法 forEach</p>
</li>
<li><p>301 和 302 的区别</p>
</li>
<li><p>模块中导出单个成员和导出多个成员的方式</p>
</li>
<li><p>module.exports 和 exports 的区别</p>
</li>
<li><p>require 方法加载规则</p>
<ul>
<li>优先从缓存加载</li>
<li>核心模块</li>
<li>路径形式的模块</li>
<li>第三方模块<ul>
<li>node_modules</li>
</ul>
</li>
</ul>
</li>
<li><p>package.json 包描述文件</p>
<ul>
<li>dependencies 选项的作用</li>
</ul>
</li>
<li><p>npm 常用命令</p>
<p>node pachage manager</p>
<p>package.json包描述文件，项目的说明书，说明了该项目依赖的包。每个项目中都要有一个</p>
<p>npm init生成</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">$ npm init</span><br><span class="line">This utility will walk you through creating a package.json file.</span><br><span class="line">It only covers the most common items, and tries to guess sensible defaults.</span><br><span class="line"></span><br><span class="line">See <span class="string">`npm help init`</span> <span class="keyword">for</span> definitive documentation on these fields</span><br><span class="line">and exactly what they <span class="keyword">do</span>.</span><br><span class="line"></span><br><span class="line">Use <span class="string">`npm install &lt;pkg&gt;`</span> afterwards to install a package and</span><br><span class="line">save it <span class="keyword">as</span> a dependency <span class="keyword">in</span> the package.json file.</span><br><span class="line"></span><br><span class="line">Press ^C at any time to quit.</span><br><span class="line">package name: (<span class="number">04</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>最有用的是dependencies选项，可以用来帮我们保存第三方包的依赖信息</p>
<ul>
<li>npm init -y可以跳过向导，快速生成</li>
<li>npm install</li>
<li>npm install –save 包名<ul>
<li>下载并保存依赖项(package.json的dependencies选项)</li>
</ul>
</li>
<li>npm uninstall –save</li>
</ul>
</li>
<li><p>Express 基本使用</p>
<p>原生http在某些地方不足，需要框架来加快开发效率</p>
<p>node中有很多web开发框架，这里以学习express为主</p>
<p><a target="_blank" rel="noopener" href="http://expressjs.com/">Express - Node.js web application framework (expressjs.com)</a></p>
</li>
<li><p>使用 Express 把之前的留言本案例自己动手改造一下</p>
</li>
</ul>
<h1 id="Node-js-第4天课堂笔记"><a href="#Node-js-第4天课堂笔记" class="headerlink" title="Node.js 第4天课堂笔记"></a>Node.js 第4天课堂笔记</h1><h2 id="知识点-2"><a href="#知识点-2" class="headerlink" title="知识点"></a>知识点</h2><ul>
<li>Express</li>
<li>基于文件做一套 CRUD</li>
</ul>
<h2 id="反馈-2"><a href="#反馈-2" class="headerlink" title="反馈"></a>反馈</h2><ul>
<li>需要记忆的内容比较多，还是得多敲多练</li>
<li>竟以为老师是理工男！！！老师每天来一波惊喜吧，魅力值up up up！</li>
<li>老师很可爱，很喜欢，学习有动力，哈哈哈哈哈哈哈哈<ul>
<li> 嘤嘤嘤</li>
</ul>
</li>
<li>php什么的相关知识，老师可能大概也许说过，但是我清楚的知道，我是真的不知道，对我来说就是新知识。恩 所以，你没有重复</li>
<li>给老师点赞</li>
<li>QAQ<ul>
<li>@_@</li>
</ul>
</li>
</ul>
<h2 id="复习-2"><a href="#复习-2" class="headerlink" title="复习"></a>复习</h2><ul>
<li><p>jQuery 的 each 和 原生的 JavaScript 方法 forEach</p>
</li>
<li><p>301 和 302 的区别</p>
</li>
<li><p>模块中导出单个成员和导出多个成员的方式</p>
<ul>
<li><code>module.exports = xxx</code></li>
<li>通过多次：<code>exports.xxx = xxx</code></li>
<li>导出多个也可以：<code>moudle.exports = &#123;多个成员&#125;</code></li>
</ul>
</li>
<li><p>module.exports 和 exports 的区别</p>
<ul>
<li>exports 只是 module.exports 的一个引用而已，目的只是为了简化写法</li>
<li>每个模块最终 return 的是 module.exports</li>
</ul>
</li>
<li><p>require 方法加载规则</p>
<ul>
<li>优先从缓存加载</li>
<li>核心模块</li>
<li>路径形式的模块<ul>
<li><code>./xxx</code></li>
<li><code>../xxxx</code></li>
<li><code>/xxxx</code> / 在这里表示的是磁盘根路径</li>
<li><code>c:/xxx</code></li>
</ul>
</li>
<li>第三方模块<ul>
<li>第三方模块的标识就是第三方模块的名称（不可能有第三方模块和核心模块的名字一致）</li>
<li>npm<ul>
<li>开发人员可以把写好的框架、库发布到 npm 上</li>
<li>使用者在使用的时候就可以很方便的通过 npm 来下载</li>
</ul>
</li>
<li>使用方式：<code>var 名字 = require(&#39;npm install 的那个包名&#39;)</code></li>
<li>node_modules</li>
<li>node_modules/express</li>
<li>node_modules/express/package.json</li>
<li>node_modules/express/package.json main</li>
<li>如果 package.json 或者 package.json main 不成立，则查找备选项：index.js</li>
<li>如果以上条件都不成立，则继续进入上一级目录中的 node_modules 按照上面的规则继续查找</li>
<li>如果直到当前文件模块所属磁盘根目录都找不到，最后报错：<code>can not find module xxx</code></li>
</ul>
</li>
</ul>
</li>
<li><p>package.json 包描述文件</p>
<ul>
<li>就是产品的说明书</li>
<li><code>dependencies</code> 属性，用来保存项目的第三方包依赖项信息</li>
<li>所以建议每个项目都要有且只有一个 package.json (存放在项目的根目录)</li>
<li>我们可以通过 <code>npm init [--yes]</code> 来生成 package.json 文件</li>
<li>同样的，为了保存依赖项信息，我们每次安装第三方包的时候都要加上：<code>--save</code> 选项。</li>
</ul>
</li>
<li><p>npm 常用命令</p>
<ul>
<li>install</li>
<li>uninstall</li>
</ul>
</li>
<li><p>Express 基本使用</p>
</li>
<li><p>使用 Express 把之前的留言本案例自己动手改造一下</p>
</li>
</ul>
<h3 id="模块标识中的-和文件操作路径中的"><a href="#模块标识中的-和文件操作路径中的" class="headerlink" title="模块标识中的 / 和文件操作路径中的 /"></a>模块标识中的 <code>/</code> 和文件操作路径中的 <code>/</code></h3><h2 id="上午总结-3"><a href="#上午总结-3" class="headerlink" title="上午总结"></a>上午总结</h2><h3 id="演讲"><a href="#演讲" class="headerlink" title="演讲"></a>演讲</h3><blockquote>
<p>说服<br>PPT<br>脑图<br>markdown<br>结构思维</p>
</blockquote>
<ul>
<li><p>找痛点 why 为什么</p>
</li>
<li><p>解决方案 what 是什么</p>
</li>
<li><p>怎么去使用 how 怎么用</p>
</li>
<li><p>where 在哪儿用</p>
</li>
<li><p>when  什么时候用</p>
</li>
<li><p>文件路径中的 <code>/</code> 和模块标识中的 <code>/</code></p>
</li>
<li><p>nodemon</p>
<p>nodemon可以自己更新文件变化</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">Administrator@zx MINGW64 /f/nodejs/<span class="number">05</span></span><br><span class="line">$ nodemon app.js</span><br><span class="line">[nodemon] <span class="number">2.0</span><span class="number">.15</span></span><br><span class="line">[nodemon] to restart at any time, enter <span class="string">`rs`</span></span><br><span class="line">[nodemon] watching path(s): *.*</span><br><span class="line">[nodemon] watching extensions: js,mjs,json</span><br><span class="line">[nodemon] starting <span class="string">`node app.js`</span></span><br><span class="line">listening on port <span class="number">3000</span></span><br><span class="line">&#123;&#125;</span><br><span class="line">[nodemon] restarting due to changes...</span><br><span class="line">[nodemon] starting <span class="string">`node app.js`</span></span><br><span class="line">listening on port <span class="number">3000</span></span><br><span class="line">[nodemon] restarting due to changes...</span><br><span class="line">[nodemon] starting <span class="string">`node app.js`</span></span><br><span class="line">listening on port <span class="number">3000</span></span><br><span class="line">&#123;&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>Express</p>
<ul>
<li>art-template 模板引擎的配置</li>
<li>body-parser 解析表单 POST 请求体</li>
</ul>
</li>
<li><p>技术只是一种解决问题的手段、工具而已</p>
<ul>
<li>第三方的东西，不要纠结</li>
<li>先以解决问题为主</li>
</ul>
</li>
<li><p>详解了 express 静态服务 API</p>
<ul>
<li>app.use(‘/public/‘, express.static(‘./public’))</li>
</ul>
</li>
<li><p>crud</p>
</li>
</ul>
<h2 id="下午总结-2"><a href="#下午总结-2" class="headerlink" title="下午总结"></a>下午总结</h2><h2 id="目标"><a href="#目标" class="headerlink" title="目标"></a>目标</h2><ul>
<li><p>文件路径中的 <code>/</code> 和模块标识中的 <code>/</code></p>
</li>
<li><p>Express 中配置使用 art-template 模板引擎</p>
<ol>
<li><p>安装</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install --save express-art-template</span><br></pre></td></tr></table></figure></li>
<li><p>配置</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">app.engine(<span class="string">&#x27;art&#x27;</span>,<span class="built_in">require</span>(<span class="string">&#x27;express-art-template&#x27;</span>))</span><br></pre></td></tr></table></figure></li>
<li><p>使用</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">app.get(<span class="string">&#x27;/&#x27;</span>,<span class="function"><span class="keyword">function</span>(<span class="params">req,res</span>)</span>&#123;</span><br><span class="line">	<span class="comment">//express默认去views目录找</span></span><br><span class="line">	res.render(<span class="string">&#x27;index.html&#x27;</span>,&#123;</span><br><span class="line">		<span class="attr">title</span>:<span class="string">&#x27;hello world&#x27;</span></span><br><span class="line">	&#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></li>
<li><p>修改默认的views试图渲染存储目录</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">app.set(<span class="string">&#x27;views&#x27;</span>,目标路径)</span><br></pre></td></tr></table></figure></li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>)</span><br><span class="line"><span class="keyword">var</span> app=express()</span><br><span class="line">app.engine(<span class="string">&#x27;html&#x27;</span>, <span class="built_in">require</span>(<span class="string">&#x27;express-art-template&#x27;</span>))</span><br><span class="line"><span class="keyword">var</span> bodyParser = <span class="built_in">require</span>(<span class="string">&#x27;body-parser&#x27;</span>)</span><br><span class="line">app.use(bodyParser.urlencoded(&#123; <span class="attr">extended</span>: <span class="literal">false</span> &#125;))</span><br><span class="line">app.use(bodyParser.urlencoded(&#123; <span class="attr">extended</span>: <span class="literal">false</span> &#125;))</span><br><span class="line"><span class="comment">// routes</span></span><br><span class="line"><span class="keyword">var</span> comments = [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">name</span>: <span class="string">&#x27;张三&#x27;</span>,</span><br><span class="line">      <span class="attr">message</span>: <span class="string">&#x27;今天天气不错！&#x27;</span>,</span><br><span class="line">      <span class="attr">dateTime</span>: <span class="string">&#x27;2015-10-16&#x27;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">name</span>: <span class="string">&#x27;张三2&#x27;</span>,</span><br><span class="line">      <span class="attr">message</span>: <span class="string">&#x27;今天天气不错！&#x27;</span>,</span><br><span class="line">      <span class="attr">dateTime</span>: <span class="string">&#x27;2015-10-16&#x27;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">name</span>: <span class="string">&#x27;张三3&#x27;</span>,</span><br><span class="line">      <span class="attr">message</span>: <span class="string">&#x27;今天天气不错！&#x27;</span>,</span><br><span class="line">      <span class="attr">dateTime</span>: <span class="string">&#x27;2015-10-16&#x27;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">name</span>: <span class="string">&#x27;张三4&#x27;</span>,</span><br><span class="line">      <span class="attr">message</span>: <span class="string">&#x27;今天天气不错！&#x27;</span>,</span><br><span class="line">      <span class="attr">dateTime</span>: <span class="string">&#x27;2015-10-16&#x27;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">name</span>: <span class="string">&#x27;张三5&#x27;</span>,</span><br><span class="line">      <span class="attr">message</span>: <span class="string">&#x27;今天天气不错！&#x27;</span>,</span><br><span class="line">      <span class="attr">dateTime</span>: <span class="string">&#x27;2015-10-16&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line"></span><br><span class="line"><span class="comment">//公开文件夹目录</span></span><br><span class="line">app.use(<span class="string">&#x27;/public&#x27;</span>,express.static(<span class="string">&#x27;./public/&#x27;</span>))</span><br><span class="line">app.get(<span class="string">&#x27;/&#x27;</span>, <span class="function"><span class="keyword">function</span>(<span class="params">req, res</span>)</span>&#123;</span><br><span class="line">    res.render(<span class="string">&#x27;index.html&#x27;</span>,&#123;</span><br><span class="line">        <span class="attr">comments</span>:comments</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">&#125;)</span><br><span class="line">app.get(<span class="string">&#x27;/post&#x27;</span>, <span class="function"><span class="keyword">function</span>(<span class="params">req, res</span>)</span>&#123;</span><br><span class="line">    res.render(<span class="string">&#x27;post.html&#x27;</span>)</span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">//以不同请求方式请求同一路径，结果不同</span></span><br><span class="line">app.post(<span class="string">&#x27;/post&#x27;</span>,<span class="function"><span class="keyword">function</span>(<span class="params">req,res</span>)</span>&#123;</span><br><span class="line">    <span class="comment">//req.query只能拿到get</span></span><br><span class="line">    <span class="comment">//插件middleware body-parser</span></span><br><span class="line">    <span class="comment">//目前使用req.body</span></span><br><span class="line">    <span class="comment">//var comment=req.query</span></span><br><span class="line">    <span class="keyword">var</span> comment=req.body</span><br><span class="line">    comment.dateTime=<span class="string">&#x27;2021-12-28 10:58:53&#x27;</span></span><br><span class="line">    comments.unshift(comment)</span><br><span class="line">    res.redirect(<span class="string">&#x27;/&#x27;</span>)</span><br><span class="line">    <span class="comment">//res.statusCode=302</span></span><br><span class="line">    <span class="comment">//res.setHeader(&#x27;location&#x27;,&#x27;/&#x27;)</span></span><br><span class="line">&#125;)</span><br><span class="line">app.listen(<span class="number">3000</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;listening on port 3000&#x27;</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></li>
<li><p>Express 中配置使用 body-parser</p>
<p>1.安装</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install body-parser</span><br></pre></td></tr></table></figure>

<p>2.解析</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> express = <span class="built_in">require</span>(<span class="string">&quot;express&quot;</span>);</span><br><span class="line"><span class="keyword">let</span> http = <span class="built_in">require</span>(<span class="string">&quot;http&quot;</span>);</span><br><span class="line"><span class="keyword">let</span> cache =<span class="built_in">require</span>(<span class="string">&quot;./redis.js&quot;</span>);   </span><br><span class="line"><span class="keyword">let</span> app = express();</span><br><span class="line"><span class="keyword">var</span> bodyParser = <span class="built_in">require</span>(<span class="string">&quot;body-parser&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//解析application/json</span></span><br><span class="line">app.use(bodyParser.json());</span><br><span class="line"></span><br><span class="line"><span class="comment">//解析application/x-www-form-urlencoded</span></span><br><span class="line">app.use(bodyParser.urlencoded());</span><br><span class="line"></span><br><span class="line">上面这些要在app.use(router)之前</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>3.使用</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">  </span><br></pre></td></tr></table></figure></li>
<li><p>Express 中配置处理静态资源</p>
</li>
<li><p>CRUD 案例中单独提取路由模块</p>
</li>
</ul>
<p>回调函数</p>
<p>异步函数获取返回值的方法</p>
<p>//setTineout</p>
<p>//readFile</p>
<p>//writeFile</p>
<p>//ajax</p>
<p>//往往异步API都伴随着一个回调函数</p>
<p>例如</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$.get(<span class="string">&quot;demo_test.asp&quot;</span>,<span class="function"><span class="keyword">function</span>(<span class="params">data,status</span>)</span>&#123;</span><br><span class="line">  alert(<span class="string">&quot;Data: &quot;</span> + data + <span class="string">&quot;\nStatus: &quot;</span> + status);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>自己封装ajax中的get方法</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">get</span>(<span class="params">url,callback</span>)</span>&#123;</span><br><span class="line">	<span class="keyword">var</span> oReq=<span class="keyword">new</span> XMLHttpRequest()</span><br><span class="line">	oReq.onload=<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">		callback(oReq.responseText)</span><br><span class="line">	&#125;</span><br><span class="line">	oReq.open(<span class="string">&#x27;get&#x27;</span>,url)</span><br><span class="line">	oReq.send()</span><br><span class="line">&#125;</span><br><span class="line">get(<span class="string">&#x27;data.json&#x27;</span>,<span class="function"><span class="keyword">function</span>(<span class="params">data</span>)</span>&#123;</span><br><span class="line">	<span class="built_in">console</span>.log(data)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>



<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">add</span>(<span class="params">x,y,callback</span>)</span>&#123;</span><br><span class="line">	<span class="built_in">setTimeout</span>(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">		<span class="keyword">var</span> ret=x+y</span><br><span class="line">		callback(ret)</span><br><span class="line">	&#125;,<span class="number">1000</span>)</span><br><span class="line">&#125;</span><br><span class="line">add(<span class="number">10</span>,<span class="number">20</span>,<span class="function"><span class="keyword">function</span>(<span class="params">ret</span>)</span>&#123;</span><br><span class="line">	<span class="built_in">console</span>.log(ret)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h1 id="Node-js-第5天课堂笔记"><a href="#Node-js-第5天课堂笔记" class="headerlink" title="Node.js 第5天课堂笔记"></a>Node.js 第5天课堂笔记</h1><h2 id="知识点-3"><a href="#知识点-3" class="headerlink" title="知识点"></a>知识点</h2><ul>
<li>Express</li>
<li>MongoDB</li>
<li>项目<ul>
<li>一天半的时间</li>
</ul>
</li>
</ul>
<h2 id="反馈-3"><a href="#反馈-3" class="headerlink" title="反馈"></a>反馈</h2><ul>
<li><p>新版sublime 怎么格式化 怎么一起选中长度不等的内容 怎么改颜色 有的写对了也没颜色 仍然是白色</p>
<ul>
<li>HTML-CSS-JS Prettify</li>
</ul>
</li>
<li><p>代码量好多</p>
<ul>
<li>真正的开发是咱们这个小案例的无数倍</li>
</ul>
</li>
<li><p>callback是不是相当于函数自调用?</p>
<ul>
<li>很简单，函数也是一种数据类型，既可以当作参数进行传递，也可以当作方法的返回值</li>
</ul>
</li>
<li><p>我们现在用的模块化是CMD吧 老师能不能给我们扩展一下AMD</p>
<ul>
<li>PHP 中为什么就可以直接 <code>require</code>、<code>include</code> 因为 PHP 当初在设计的时候就加入了这个功能</li>
<li>PHP 这门语言天生就支持</li>
<li>模块作用域</li>
<li>可以使用 API 来进行文件与文件之间的依赖加载</li>
<li>在 Node 这个环境中对 JavaScript 进行了特殊的模块化支持 CommonJS</li>
<li>JavaScript 天生不支持模块化<ul>
<li>require</li>
<li>exports</li>
<li>Node.js 才有的</li>
</ul>
</li>
<li>在浏览器中也可以像在 Node 中的模块一样来进行编程<ul>
<li><code>&lt;script&gt;</code> 标签来引用加载，而且你还必须考虑加载的顺序问题</li>
<li>require.js 第三方库 AMD</li>
<li>sea.js     第三方库 CMD</li>
</ul>
</li>
<li>无论是 CommonJS、AMD、CMD、UMD、EcmaScript 6 Modules 官方规范<ul>
<li>都是为了解决 JavaScript 的模块化问题</li>
<li>CommonJS、AMD、CMD 都是民间搞出来的</li>
<li>EcmaScript 是官方规范定义</li>
<li>官方看民间都在乱搞，开发人员为了在不同的环境使用不同的 JavaScript 模块化解决方案</li>
<li>所以 EcmaScript 在 2015 年发布了 EcmaScript 2016 官方标准</li>
<li>其中就包含了官方对 JavaScript 模块化的支持</li>
<li>也就是说语言天生就支持了</li>
<li>但是虽然标准已经发布了，但是很多 JavaScript 运行换将还不支持</li>
<li>Node 也是只在 8.5 版本之后才对 EcmaScript 6 module 进行了支持</li>
<li>后面学 Vue 的时候会去学习</li>
<li>less 编译器 &gt; css</li>
<li>EcmaScript 6 -&gt; 编译器 -&gt; EcmaScript 5</li>
<li>目前的前端情况都是使用很多新技术，然后利用编译器工具打包可以在低版本浏览器运行。</li>
<li>使用新技术的目的就是为了提高效率，增加可维护性</li>
</ul>
</li>
</ul>
</li>
<li><p>内心极度脆弱。。。有心杀敌 无力回天，总感觉时间不够用。</p>
<ul>
<li>不要猥琐发育，就得浪</li>
</ul>
</li>
<li><p>虽然比较多 但是因为老师讲的很清晰 还是愿意去写的 对于 node.js 的奥义 封装异步的API 就是需要多练</p>
</li>
<li><p>老师讲的很清晰 讲课也很洒脱 老师是不是被夸的已经习惯了 后面讲的回掉函数有点懵了</p>
</li>
<li><p>老师讲的很好，思路清晰，项目跟着老师的笔记一步一步敲，so easy</p>
</li>
<li><p>觉得老师讲课真的超级棒啊 传智的实力担当 双击没毛病 老铁666</p>
</li>
<li><p>都坐下 基本操作 哇,老师,一般敢说这句话的都是大神,我还是个菜鸟,学的那是一脸懵逼</p>
</li>
<li><p>有点懵，看着老师的思路做，可是还是不知道从何入手，唉。。。</p>
<ul>
<li> 本着达芬奇画鸡蛋的精神</li>
<li> 《使徒行者》三哥</li>
<li>《反黑》陈小春<ul>
<li> 卧底 8年卧底</li>
<li> 文职工作</li>
<li> 报了电脑版</li>
<li> 吃饭都在看书</li>
<li> 学习 -》吃饭也是看书</li>
<li> 边角余料</li>
</ul>
</li>
</ul>
</li>
<li><p>var router = require(‘./router’) 这一步不是加载router.js并执行该文件吗 为什么还要执行app.use(router) app.use 不是开放静态资源吗 app.use(router)在这里是什么意思，挂载到 app 服务中的意思是？ module.exports = app 也不懂</p>
<ul>
<li>这里涉及到一个中间件的概念</li>
<li>app.use 不仅仅是用来处理静态资源的</li>
<li>还可以做很多工作</li>
<li>配置 body-parse 也是通过 app.use 来配置的</li>
<li>这叫中间件，其中有一套规则</li>
</ul>
</li>
<li><p>npm init –yes 生成一个package.json 文件 npm –save 文件名 又生成一个package-lock.json文件,又生成的文件和初始化生成的文件有区别吗?</p>
<p> npm5之前没有package.json</p>
<p> npm5以后才加入了这个文件</p>
<ul>
<li>当你安装包的时候，新版的 npm 还会自动生成一个文件：package-lock.json</li>
<li>npm5以后的版本安装包不需要加–save参数就能保存一来信息</li>
<li>当安装包时，会自动创建或者更新package.json</li>
<li>package-lock.json保存了node_modules中所有包的依赖树(版本、下载信息)</li>
<li>这样npm install速度增加</li>
<li>lock是锁定版本的</li>
</ul>
</li>
<li><p>早上听的还可以，下午感觉一头蒙，还好老师讲了晚上自己做案例的具体步骤，不然感觉无从下手，还是反馈多一点好，还可以回顾回顾，不然感觉老师一天讲的知识太多了，消化不了，嘤嘤嘤~~~</p>
</li>
<li><p>其实拖堂的效率也不高啊。。可能是我天资愚笨</p>
<ul>
<li>对自己有信息</li>
<li>撸起袖子加油干、一张蓝图绘到底</li>
</ul>
</li>
<li><p>老师你好，每节课的事件有点长，上课时间长注意力就容易模糊。听课效率确实有问题，有时候同桌都快憋不住了，为了不丢下知识点，依旧在憋着，好担心…</p>
</li>
<li><p>为什么模板引擎在app.js中引入之后在router.js中不引入可以直接使用，而express还需要在router.js中再引入一次 app.js中路由器挂载不是很懂 router.js中为什么要创建一个路由器容器，不知道作用是干什么的 es6中的find方法不是很懂</p>
<ul>
<li>中间件</li>
<li>EcmaScript 6 的 find 方法和findindexES6为Array增加了find()，findIndex函数。find()函数用来查找第一个符合条件的目标元素，找到就返回该元素，找不到返回undefined。findIndex()函数也是查找第一个符合条件的目标元素，找到就返回元素的位置，找不到就返回-1。他们的都是一个查找回调函数。<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>].find(<span class="function">(<span class="params">value, index, arr</span>) =&gt;</span> &#123;</span><br><span class="line">  </span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

查找函数有三个参数。value：每一次迭代查找的数组元素。index：每一次迭代查找的数组元素索引。arr：被查找的数组<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> arr1 = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">10</span>, <span class="number">11</span>]</span><br><span class="line"><span class="keyword">var</span> ret1 = arr1.find(<span class="function">(<span class="params">value, index, arr</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> value &gt; <span class="number">4</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> ret2 = arr1.find(<span class="function">(<span class="params">value, index, arr</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> value &gt; <span class="number">14</span></span><br><span class="line">&#125;)</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&#x27;%s&#x27;</span>, ret1)</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&#x27;%s&#x27;</span>, ret2)</span><br><span class="line"></span><br><span class="line">结果：</span><br><span class="line"><span class="number">5</span></span><br><span class="line"><span class="literal">undefined</span></span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> ret3 = arr1.findIndex(<span class="function">(<span class="params">value, index, arr</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> value &gt; <span class="number">4</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> ret4 = arr1.findIndex(<span class="function">(<span class="params">value, index, arr</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> value &gt; <span class="number">14</span></span><br><span class="line">&#125;)</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&#x27;%s&#x27;</span>, ret3)</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&#x27;%s&#x27;</span>, ret4)</span><br><span class="line"></span><br><span class="line">结果：</span><br><span class="line"><span class="number">4</span></span><br><span class="line">-<span class="number">1</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>老师，你后来讲的回调函数那里，关于增删改查案例一个已经够呛了，你竟然在最后都讲完了； 虽然增删改查文件的操作在php之前讲过，但是真的忘了，而且php学的也不好； 还有：对于php是世界上最好的语言，我持怀疑态度，觉得它是世界上最难理解的语言； 诶！苦恼！又来了一个node，知道后边的boss都很难应付，比如什么angular、react和vue，现在其实也做好了心理准备！ 来者不拒吧！看来这一个月注定是一个煎熬的日子！</p>
<ul>
<li>PHP 是世界上最好的语言（贬义）</li>
<li>一切我抗</li>
</ul>
</li>
<li><p>在express框架中怎么判断访问页面不存在的情况？</p>
<ol>
<li>对于没有设定的路径，默认返回can not get xxx</li>
<li>如果想要定制404，需要通过中间件设置</li>
<li>只需要在自己的路由之后增加一个</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">app.use(<span class="function"><span class="keyword">function</span>(<span class="params">req,res</span>)</span>&#123;</span><br><span class="line">	<span class="comment">//所有未处理的请求路径都会跑到这里</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="复习-3"><a href="#复习-3" class="headerlink" title="复习"></a>复习</h2><ul>
<li>文件路径中的 <code>/</code> 和模块标识中的 <code>/</code></li>
<li>Express 中配置使用 art-template 模板引擎</li>
<li>Express 中配置使用 body-parser</li>
<li>Express 中配置处理静态资源</li>
<li>CRUD 案例中单独提取路由模块</li>
</ul>
<h2 id="上午总结-4"><a href="#上午总结-4" class="headerlink" title="上午总结"></a>上午总结</h2><ul>
<li>回调函数<ul>
<li>异步编程</li>
<li>如果需要得到一个函数内部异步操作的结果，这是时候必须通过回调函数来获取</li>
<li>在调用的位置传递一个函数进来</li>
<li>在封装的函数内部调用传递进来的函数</li>
</ul>
</li>
<li>find、findIndex、forEach<ul>
<li>数组的遍历方法，都是对函数作为参数一种运用<ul>
<li>every</li>
</ul>
</li>
<li>some</li>
<li>includes</li>
<li>map</li>
<li>reduce</li>
</ul>
</li>
<li>package-lock.json 文件的作用<ul>
<li>下载速度快了</li>
<li>锁定版本</li>
</ul>
</li>
<li>JavaScript 模块化<ul>
<li>Node 中的 CommonJS</li>
<li>浏览器中的<ul>
<li>AMD require.js</li>
<li>CMD sea.js</li>
</ul>
</li>
<li>EcmaScript 官方在 EcmaScript 6 中增加了官方支持</li>
<li>EcmaScript 6</li>
<li>后面我们会学，编译工具</li>
</ul>
</li>
<li>MongoDB 数据库<ul>
<li>MongoDB 的数据存储结构<ul>
<li>数据库</li>
<li>集合（表）</li>
<li>文档（表记录）</li>
</ul>
</li>
</ul>
</li>
<li>MongoDB 官方有一个 mongodb 的包可以用来操作 MongoDB 数据库<ul>
<li>这个确实和强大，但是比较原始，麻烦，所以咱们不使用它</li>
</ul>
</li>
<li>mongoose<ul>
<li>真正在公司进行开发，使用的是 mongoose 这个第三方包</li>
<li>它是基于 MongoDB 官方的 mongodb 包进一步做了封装</li>
<li>可以提高开发效率</li>
<li>让你操作 MongoDB 数据库更方便</li>
</ul>
</li>
<li>掌握使用 mongoose 对数据集合进行基本的 CRUD</li>
<li>把之前的 crud 案例改为了 MongoDB 数据库版本</li>
<li>使用 Node 操作 mysql 数据库</li>
</ul>
<h3 id="MongoDB"><a href="#MongoDB" class="headerlink" title="MongoDB"></a>MongoDB</h3><h4 id="关系型数据库和非关系型数据库"><a href="#关系型数据库和非关系型数据库" class="headerlink" title="关系型数据库和非关系型数据库"></a>关系型数据库和非关系型数据库</h4><p>表就是关系，表和表之间存在关系</p>
<ul>
<li>所有的关系型数据库都需要通过sql语言编写</li>
<li>所有关系型数据库都需要设计表结构</li>
<li>而且表还支持约束<ul>
<li>唯一性</li>
<li>主键</li>
<li>默认值</li>
<li>非空</li>
</ul>
</li>
<li>非关系数据可非常灵活，key-value</li>
<li>MongoDB是长得最像关系型数据<ul>
<li>数据库-》数据库</li>
<li>数据表-》集合</li>
<li>表记录-》文档对象</li>
</ul>
</li>
<li>MongoDB不需要设计表结构</li>
<li>可以任意地往里面存东西，没有结构性的说法</li>
<li>MOngoDB可以有多个数据库</li>
<li>一个数据库可以有多个集合(表记录)</li>
</ul>
<h4 id="启动关闭数据库"><a href="#启动关闭数据库" class="headerlink" title="启动关闭数据库"></a>启动关闭数据库</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mongod</span><br><span class="line">#第一次执行手动建立/data/db文件夹</span><br></pre></td></tr></table></figure>

<p>修改默认存储目录</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mongod --dbpath 数据存储路径(/data/db)</span><br></pre></td></tr></table></figure>

<p>停止</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ctrl+c</span><br><span class="line">关闭开启服务的控制台</span><br></pre></td></tr></table></figure>

<h4 id="链接数据库"><a href="#链接数据库" class="headerlink" title="链接数据库"></a>链接数据库</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mongo</span><br><span class="line">#默认连接本机的MongoDB服务</span><br></pre></td></tr></table></figure>

<p>退出</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">#在连接状态输入exit</span><br></pre></td></tr></table></figure>

<h4 id="常见命令"><a href="#常见命令" class="headerlink" title="常见命令"></a>常见命令</h4><ul>
<li><p><code>show dbs</code></p>
<ul>
<li>查看显示所有的数据库</li>
</ul>
</li>
<li><p><code>use 数据库名称</code>  </p>
<ul>
<li>切换指定数据库</li>
</ul>
</li>
<li><p>插入数据</p>
<ul>
<li><p><code>db.students.insertOne(&#123;&quot;name&quot;:&quot;zx&quot;&#125;)</code></p>
<p><img src="https://s2.loli.net/2022/01/04/yp9fwtEXM6oNOH2.png" alt="image-20220104221123204"></p>
</li>
<li><p><code>show collections</code></p>
<p><img src="https://s2.loli.net/2022/01/04/P9WQ8n5CTSD1HbZ.png" alt="image-20220104221242127"></p>
</li>
<li><p><code>db.students.find()</code></p>
<p><img src="https://s2.loli.net/2022/01/04/PVeZRcWwO6otxu1.png" alt="image-20220104221103349"></p>
</li>
</ul>
</li>
</ul>
<h4 id="node中如何操纵MongoDB数据"><a href="#node中如何操纵MongoDB数据" class="headerlink" title="node中如何操纵MongoDB数据"></a>node中如何操纵MongoDB数据</h4><p>使用官方的Mongodb npm上搜索mongodb</p>
<p><a target="_blank" rel="noopener" href="https://github.com/mongodb/node-mongodb-native">https://github.com/mongodb/node-mongodb-native</a></p>
<h4 id="使用第三方mongoose来操作MongoDB数据库"><a href="#使用第三方mongoose来操作MongoDB数据库" class="headerlink" title="使用第三方mongoose来操作MongoDB数据库"></a>使用第三方mongoose来操作MongoDB数据库</h4><p>第三方包:<code>mongoose</code>基于Mongodb官方的mongodb包再一次做了封装</p>
<p>mongoosejs.com</p>
<p><em>请先安装 <a target="_blank" rel="noopener" href="http://www.mongodb.org/downloads">MongoDB</a> 和 <a target="_blank" rel="noopener" href="http://nodejs.org/">Node.js</a>。</em></p>
<p>下一步，<code>npm</code>安装Mongoose:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ npm install mongoose</span><br></pre></td></tr></table></figure>

<p>假设我们都很喜欢喵星人，想在MongoDB里记录每只我们见过的喵星人。 首先我们要在项目中引入 mongoose ，然后连接我们本地的 <code>test</code> 数据库。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// getting-started.js</span></span><br><span class="line"><span class="keyword">var</span> mongoose = <span class="built_in">require</span>(<span class="string">&#x27;mongoose&#x27;</span>);</span><br><span class="line">mongoose.connect(<span class="string">&#x27;mongodb://localhost/test&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p><code>connect()</code> 返回一个状态待定（pending）的连接， 接着我们加上成功提醒和失败警告。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> db = mongoose.connection;</span><br><span class="line">db.on(<span class="string">&#x27;error&#x27;</span>, <span class="built_in">console</span>.error.bind(<span class="built_in">console</span>, <span class="string">&#x27;connection error:&#x27;</span>));</span><br><span class="line">db.once(<span class="string">&#x27;open&#x27;</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="comment">// we&#x27;re connected!</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>连接成功时，回调函数会被调用。简洁起见， 我们假设下面所有函数都运行在这个回调函数里。</p>
<p>Mongoose 里，一切都始于<a target="_blank" rel="noopener" href="http://www.mongoosejs.net/docs/guide.html">Schema</a>。 现在我们来看一个例子：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> kittySchema = mongoose.Schema(&#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="built_in">String</span></span><br><span class="line">    password：&#123;</span><br><span class="line">    	<span class="attr">type</span>:<span class="built_in">String</span>,</span><br><span class="line">    <span class="attr">required</span>:<span class="literal">true</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>很好，我们得到了一个带有 <code>String</code> 类型 <code>name</code> 属性的 schema 。 接着我们需要把这个 schema 编译成一个 <a target="_blank" rel="noopener" href="http://www.mongoosejs.net/docs/models.html">Model</a>：</p>
<p>传一个大写字母的字符串表示表的名称，mongoose会自动将大写名词的字符串生成<strong>小写复数</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> Kitten = mongoose.model(<span class="string">&#x27;Kitten&#x27;</span>, kittySchema);</span><br></pre></td></tr></table></figure>

<p>model 是我们构造 document 的 Class。 在例子中，每个 document 都是一只喵，它的属性和行为都会被声明在 schema。 现在我们来“创造”一只猫：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> felyne = <span class="keyword">new</span> Kitten(&#123; <span class="attr">name</span>: <span class="string">&#x27;Felyne&#x27;</span> &#125;);</span><br><span class="line"><span class="built_in">console</span>.log(felyne.name); <span class="comment">// &#x27;Felyne&#x27;</span></span><br></pre></td></tr></table></figure>

<p>不会喵怎么算喵星人，现在给喵星人 document 加个 “speak” 方法：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 译者注：注意了， method 是给 document 用的</span></span><br><span class="line"><span class="comment">// <span class="doctag">NOTE:</span> methods must be added to the schema before compiling it with mongoose.model()</span></span><br><span class="line">kittySchema.methods.speak = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> greeting = <span class="built_in">this</span>.name</span><br><span class="line">    ? <span class="string">&quot;Meow name is &quot;</span> + <span class="built_in">this</span>.name</span><br><span class="line">    : <span class="string">&quot;I don&#x27;t have a name&quot;</span>;</span><br><span class="line">  <span class="built_in">console</span>.log(greeting);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> Kitten = mongoose.model(<span class="string">&#x27;Kitten&#x27;</span>, kittySchema);</span><br></pre></td></tr></table></figure>

<p>加在 schema <code>methods</code> 属性的函数会编译到 <code>Model</code> 的 prototype， 也会暴露到每个 document 实例：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> fluffy = <span class="keyword">new</span> Kitten(&#123; <span class="attr">name</span>: <span class="string">&#x27;fluffy&#x27;</span> &#125;);</span><br><span class="line">fluffy.speak(); <span class="comment">// &quot;Meow name is fluffy&quot;</span></span><br></pre></td></tr></table></figure>

<p>赞！是一只会说话的瞄星人！emmmmm虽然我们还没吧它存到数据库里。 每个 document 会在调用他的 <a target="_blank" rel="noopener" href="http://www.mongoosejs.net/docs/api.html#model_Model-save">save</a> 方法后保存到数据库。 注意回调函数的第一个参数永远是 error 。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">fluffy.save(<span class="function"><span class="keyword">function</span> (<span class="params">err, fluffy</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (err) <span class="keyword">return</span> <span class="built_in">console</span>.error(err);</span><br><span class="line">  fluffy.speak();</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>后来我们收集了好多喵，就可以通过以下方法获取喵星人 <a target="_blank" rel="noopener" href="http://www.mongoosejs.net/docs/models.html">model</a> 里的所有数据：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Kitten.find(<span class="function"><span class="keyword">function</span> (<span class="params">err, kittens</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (err) <span class="keyword">return</span> <span class="built_in">console</span>.error(err);</span><br><span class="line">  <span class="built_in">console</span>.log(kittens);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>如果我们想获取特定的数据， 可以了解一下 <a target="_blank" rel="noopener" href="http://www.mongoosejs.net/docs/queries.html">query</a>。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 这么写可以获取所有 name 为 &quot;Fluff&quot; 开头的数据</span></span><br><span class="line">Kitten.find(&#123; <span class="attr">name</span>: <span class="regexp">/^fluff/</span> &#125;, callback);</span><br></pre></td></tr></table></figure>

<p>查询所有：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Kitten.find(<span class="function"><span class="keyword">function</span> (<span class="params">err, kittens</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (err)</span><br><span class="line">      <span class="keyword">return</span> <span class="built_in">console</span>.error(err);</span><br><span class="line">  <span class="keyword">else</span>&#123;</span><br><span class="line">  	  <span class="built_in">console</span>.log(kittens);      </span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>按条件查询</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Kitten.find(&#123;<span class="attr">name</span>:fluff&#125;,<span class="function"><span class="keyword">function</span> (<span class="params">err, kittens</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (err)</span><br><span class="line">      <span class="keyword">return</span> <span class="built_in">console</span>.error(err);</span><br><span class="line">  <span class="keyword">else</span>&#123;</span><br><span class="line">  	  <span class="built_in">console</span>.log(kittens);      </span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>删除</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Kitten.remove(&#123;<span class="attr">name</span>:fluff&#125;,<span class="function"><span class="keyword">function</span> (<span class="params">err, kittens</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (err)</span><br><span class="line">      <span class="keyword">return</span> <span class="built_in">console</span>.error(err);</span><br><span class="line">  <span class="keyword">else</span>&#123;</span><br><span class="line">  	  <span class="built_in">console</span>.log(kittens);      </span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line">现在推荐使用deleteOne和deleteMany</span><br></pre></td></tr></table></figure>

<p>增加数据需要先new再save</p>
<h3 id="MySQL"><a href="#MySQL" class="headerlink" title="MySQL"></a>MySQL</h3><p>1.安装</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> npm install mysql</span></span><br></pre></td></tr></table></figure>

<p>2.使用</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> mysql      = <span class="built_in">require</span>(<span class="string">&#x27;mysql&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> connection = mysql.createConnection(&#123;</span><br><span class="line">  <span class="attr">host</span>     : <span class="string">&#x27;localhost&#x27;</span>,</span><br><span class="line">  <span class="attr">user</span>     : <span class="string">&#x27;me&#x27;</span>,</span><br><span class="line">  <span class="attr">password</span> : <span class="string">&#x27;secret&#x27;</span>,</span><br><span class="line">  <span class="attr">database</span> : <span class="string">&#x27;my_db&#x27;</span></span><br><span class="line">&#125;);</span><br><span class="line"> </span><br><span class="line">connection.connect();</span><br><span class="line"> </span><br><span class="line">connection.query(<span class="string">&#x27;SELECT 1 + 1 AS solution&#x27;</span>, <span class="function"><span class="keyword">function</span> (<span class="params">error, results, fields</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (error) <span class="keyword">throw</span> error;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&#x27;The solution is: &#x27;</span>, results[<span class="number">0</span>].solution);</span><br><span class="line">&#125;);</span><br><span class="line"> </span><br><span class="line">connection.end();</span><br></pre></td></tr></table></figure>



<h2 id="下午总结-3"><a href="#下午总结-3" class="headerlink" title="下午总结"></a>下午总结</h2><h3 id="回调地狱callbackHell"><a href="#回调地狱callbackHell" class="headerlink" title="回调地狱callbackHell"></a>回调地狱callbackHell</h3><p>JavaScript 由于某种原因是被设计为单线程的，同时由于 JavaScript 在设计之初是用于浏览器的 GUI 编程，这也就需要线程不能进行阻塞</p>
<p>所以在后续的发展过程中基本都采用异步非阻塞的编程模式</p>
<p>简单来说，异步编程就是在执行一个指令之后不是马上得到结果，而是继续执行后面的指令，等到特定的事件触发后，才得到结果</p>
<p>也正是因为这样，我们常常会说: JavaScript 是由事件驱动的</p>
<p>我用Node来解释一下，回调地狱原理非常简单：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 读取文件 */</span></span><br><span class="line">fs.readFile(<span class="string">&#x27;a.txt&#x27;</span>,<span class="string">&#x27;utf8&#x27;</span>,<span class="function"><span class="keyword">function</span>(<span class="params">error,data</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(error)&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">console</span>.log(<span class="string">&#x27;读取数据失败！&#x27;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&#x27;a&#x27;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"> </span><br><span class="line">fs.readFile(<span class="string">&#x27;b.txt&#x27;</span>,<span class="string">&#x27;utf8&#x27;</span>,<span class="function"><span class="keyword">function</span>(<span class="params">error,data</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(error)&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">console</span>.log(<span class="string">&#x27;读取数据失败！&#x27;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">console</span>.log(‘b’);</span><br><span class="line">&#125;);</span><br><span class="line"> </span><br><span class="line">fs.readFile(<span class="string">&#x27;c.txt&#x27;</span>,<span class="string">&#x27;utf8&#x27;</span>,<span class="function"><span class="keyword">function</span>(<span class="params">error,data</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(error)&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">console</span>.log(<span class="string">&#x27;读取数据失败！&#x27;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&#x27;c&#x27;</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>上面的代码是读取3个不同的文件，读取完成分别打印a、b、c</p>
<p>那么上面代码的打印结果有顺序吗？是 a b c 吗？</p>
<p>上面的代码是异步执行的，没有人敢保证打印的顺序肯定是 a b c，这就是 <strong>异步编程</strong></p>
<p><strong>现在我们有个需求，a文件读完了再读b，b读完了再读c：</strong></p>
<p>我们可以这样写：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">fs.readFile(<span class="string">&#x27;a.txt&#x27;</span>,<span class="string">&#x27;utf8&#x27;</span>,<span class="function"><span class="keyword">function</span>(<span class="params">error,data</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(error)&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">console</span>.log(<span class="string">&#x27;读取数据失败！&#x27;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&#x27;a&#x27;</span>);</span><br><span class="line"> </span><br><span class="line">  fs.readFile(<span class="string">&#x27;b.txt&#x27;</span>,<span class="string">&#x27;utf8&#x27;</span>,<span class="function"><span class="keyword">function</span>(<span class="params">error,data</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(error)&#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="built_in">console</span>.log(<span class="string">&#x27;读取数据失败！&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;b&#x27;</span>);</span><br><span class="line"> </span><br><span class="line">    fs.readFile(<span class="string">&#x27;c.txt&#x27;</span>,<span class="string">&#x27;utf8&#x27;</span>,<span class="function"><span class="keyword">function</span>(<span class="params">error,data</span>)</span>&#123;</span><br><span class="line">      <span class="keyword">if</span>(error)&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">console</span>.log(<span class="string">&#x27;读取数据失败！&#x27;</span>);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">&#x27;c&#x27;</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>这样就保证了 a 读取完在读 b，b读取完在读 c 了</p>
<p>上面这种代码的书写方式其实就是 <strong>回调地狱</strong>，一层套一层，维护起来及其困难，如果有100个文件怎么办？</p>
<p>下面这张图是个经典的 <strong>Callback hell（回调地狱）</strong></p>
<p><img src="https://s2.loli.net/2022/01/07/bnBeAEy2KF81H3i.jpg" alt="img"></p>
<p>使用<a target="_blank" rel="noopener" href="https://www.yulei1989.com/promise/"> Promise</a> 解决回调地狱问题</p>
<p>ECMAscript 6 原生提供了 Promise 对象。</p>
<p>Promise 对象代表了未来将要发生的事件，用来传递异步操作的消息。</p>
<h3 id="Promise对象特点"><a href="#Promise对象特点" class="headerlink" title="Promise对象特点"></a>Promise对象特点</h3><p>1、对象的状态不受外界影响。Promise 对象代表一个异步操作，有三种状态：</p>
<ul>
<li>pending: 初始状态，不是成功或失败状态。</li>
<li>fulfilled: 意味着操作成功完成。</li>
<li>rejected: 意味着操作失败。</li>
</ul>
<p>只有异步操作的结果，可以决定当前是哪一种状态，任何其他操作都无法改变这个状态。这也是 Promise 这个名字的由来，它的英语意思就是「承诺」，表示其他手段无法改变。</p>
<p>2、一旦状态改变，就不会再变，任何时候都可以得到这个结果。Promise 对象的状态改变，只有两种可能：从 Pending 变为 Resolved 和从 Pending 变为 Rejected。只要这两种情况发生，状态就凝固了，不会再变了，会一直保持这个结果。就算改变已经发生了，你再对 Promise 对象添加回调函数，也会立即得到这个结果。这与事件（Event）完全不同，事件的特点是，如果你错过了它，再去监听，是得不到结果的。</p>
<h3 id="promise优缺点"><a href="#promise优缺点" class="headerlink" title="promise优缺点"></a>promise优缺点</h3><p>有了 Promise 对象，就可以将异步操作以同步操作的流程表达出来，避免了层层嵌套的回调函数。此外，Promise 对象提供统一的接口，使得控制异步操作更加容易。</p>
<p>Promise 也有一些缺点。首先，无法取消 Promise，一旦新建它就会立即执行，无法中途取消。其次，如果不设置回调函数，Promise 内部抛出的错误，不会反应到外部。第三，当处于 Pending 状态时，无法得知目前进展到哪一个阶段（刚刚开始还是即将完成）</p>
<h3 id="promise创建"><a href="#promise创建" class="headerlink" title="promise创建"></a>promise创建</h3><p>要想创建一个 promise 对象、可以使用 new 来调用 Promise 的构造器来进行实例化。</p>
<p>下面是创建 promise 的步骤：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> promise = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// 异步处理</span></span><br><span class="line">    <span class="comment">// 处理结束后、调用resolve 或 reject</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>Promise 构造函数包含一个参数和一个带有 resolve（解析）和 reject（拒绝）两个参数的回调。在回调中执行一些操作（例如异步），如果一切都正常，则调用 resolve，否则调用 reject。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> myFirstPromise = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve, reject</span>)</span>&#123;</span><br><span class="line">    <span class="comment">//当异步代码执行成功时，我们才会调用resolve(...), 当异步代码失败时就会调用reject(...)</span></span><br><span class="line">    <span class="comment">//在本例中，我们使用setTimeout(...)来模拟异步代码，实际编码时可能是XHR请求或是HTML5的一些API方法.</span></span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        resolve(<span class="string">&quot;成功!&quot;</span>); <span class="comment">//代码正常执行！</span></span><br><span class="line">    &#125;, <span class="number">250</span>);</span><br><span class="line">&#125;);</span><br><span class="line"> </span><br><span class="line">myFirstPromise.then(<span class="function"><span class="keyword">function</span>(<span class="params">successMessage</span>)</span>&#123;</span><br><span class="line">    <span class="comment">//successMessage的值是上面调用resolve(...)方法传入的值.</span></span><br><span class="line">    <span class="comment">//successMessage参数不一定非要是字符串类型，这里只是举个例子</span></span><br><span class="line">    <span class="built_in">document</span>.write(<span class="string">&quot;Yay! &quot;</span> + successMessage);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>对于已经实例化过的 promise 对象可以调用 promise.then() 方法，传递 resolve 和 reject 方法作为回调。</p>
<p>promise.then() 是 promise 最为常用的方法。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">promise.then(onFulfilled, onRejected)</span><br></pre></td></tr></table></figure>

<p>promise简化了对error的处理，上面的代码我们也可以这样写：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">promise.then(onFulfilled).catch(onRejected)</span><br></pre></td></tr></table></figure>

<p>下面是一个用 Promise 对象实现的 Ajax 操作的例子。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">ajax</span>(<span class="params">URL</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span> (<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> req = <span class="keyword">new</span> XMLHttpRequest(); </span><br><span class="line">        req.open(<span class="string">&#x27;GET&#x27;</span>, URL, <span class="literal">true</span>);</span><br><span class="line">        req.onload = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (req.status === <span class="number">200</span>) &#123; </span><br><span class="line">                resolve(req.responseText);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                reject(<span class="keyword">new</span> <span class="built_in">Error</span>(req.statusText));</span><br><span class="line">            &#125; </span><br><span class="line">        &#125;;</span><br><span class="line">        req.onerror = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">            reject(<span class="keyword">new</span> <span class="built_in">Error</span>(req.statusText));</span><br><span class="line">        &#125;;</span><br><span class="line">        req.send(); </span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> URL = <span class="string">&quot;/try/ajax/testpromise.php&quot;</span>; </span><br><span class="line">ajax(URL).then(<span class="function"><span class="keyword">function</span> <span class="title">onFulfilled</span>(<span class="params">value</span>)</span>&#123;</span><br><span class="line">    <span class="built_in">document</span>.write(<span class="string">&#x27;内容是：&#x27;</span> + value); </span><br><span class="line">&#125;).catch(<span class="function"><span class="keyword">function</span> <span class="title">onRejected</span>(<span class="params">error</span>)</span>&#123;</span><br><span class="line">    <span class="built_in">document</span>.write(<span class="string">&#x27;错误：&#x27;</span> + error); </span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>catch是捕捉错误</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">getJSON(<span class="string">&quot;/posts.json&quot;</span>).then(<span class="function"><span class="keyword">function</span>(<span class="params">posts</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// some code</span></span><br><span class="line">&#125;).catch(<span class="function"><span class="keyword">function</span>(<span class="params">error</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// 处理前一个回调函数运行时发生的错误</span></span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&#x27;发生错误！&#x27;</span>, error);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>Promise.all 方法用于将多个 Promise 实例，包装成一个新的 Promise 实例。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> p = <span class="built_in">Promise</span>.all([p1,p2,p3]);</span><br></pre></td></tr></table></figure>

<p>上面代码中，Promise.all 方法接受一个数组作为参数，p1、p2、p3 都是 Promise 对象的实例。（Promise.all 方法的参数不一定是数组，但是必须具有 iterator 接口，且返回的每个成员都是 Promise 实例。）</p>
<p>p 的状态由 p1、p2、p3 决定，分成两种情况。</p>
<ul>
<li>（1）只有p1、p2、p3的状态都变成fulfilled，p的状态才会变成fulfilled，此时p1、p2、p3的返回值组成一个数组，传递给p的回调函数。</li>
<li>（2）只要p1、p2、p3之中有一个被rejected，p的状态就变成rejected，此时第一个被reject的实例的返回值，会传递给p的回调函数。</li>
</ul>
<p>下面是一个具体的例子。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 生成一个Promise对象的数组</span></span><br><span class="line"><span class="keyword">var</span> promises = [<span class="number">2</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">11</span>, <span class="number">13</span>].map(<span class="function"><span class="keyword">function</span>(<span class="params">id</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">return</span> getJSON(<span class="string">&quot;/post/&quot;</span> + id + <span class="string">&quot;.json&quot;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"> </span><br><span class="line"><span class="built_in">Promise</span>.all(promises).then(<span class="function"><span class="keyword">function</span>(<span class="params">posts</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// ...  </span></span><br><span class="line">&#125;).catch(<span class="function"><span class="keyword">function</span>(<span class="params">reason</span>)</span>&#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>Promise.race 方法同样是将多个 Promise 实例，包装成一个新的 Promise 实例。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> p = <span class="built_in">Promise</span>.race([p1,p2,p3]);</span><br></pre></td></tr></table></figure>

<p>上面代码中，只要p1、p2、p3之中有一个实例率先改变状态，p的状态就跟着改变。那个率先改变的Promise实例的返回值，就传递给p的返回值。</p>
<p>如果Promise.all方法和Promise.race方法的参数，不是Promise实例，就会先调用下面讲到的Promise.resolve方法，将参数转为Promise实例，再进一步处理。</p>
<p><img src="https://s2.loli.net/2022/01/07/FsDvZxtCUm4zd6S.png" alt="image-20220107093016160"></p>
<p><img src="https://s2.loli.net/2022/01/07/p48mojYLPWqHexw.png" alt="image-20220107095921251"></p>
<p>return 字符时</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> fs=<span class="built_in">require</span>(<span class="string">&quot;fs&quot;</span>);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&quot;1&quot;</span>)</span><br><span class="line"><span class="keyword">var</span> p1=<span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve, reject</span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;2&quot;</span>)</span><br><span class="line">    fs.readFile(<span class="string">&#x27;F:\\nodejs\\code\\a.txt&#x27;</span>,<span class="string">&#x27;utf8&#x27;</span>,<span class="function"><span class="keyword">function</span>(<span class="params">err,data</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(err)&#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">&quot;3&quot;</span>)</span><br><span class="line">            <span class="comment">//pending变成rejected</span></span><br><span class="line">            reject(err)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">&quot;4&quot;</span>)</span><br><span class="line">            <span class="comment">//resolve实际上就是then方法传递的那个function</span></span><br><span class="line">            resolve(data)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> p2=<span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve, reject</span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;2&quot;</span>)</span><br><span class="line">    fs.readFile(<span class="string">&#x27;F:\\nodejs\\code\\b.txt&#x27;</span>,<span class="string">&#x27;utf8&#x27;</span>,<span class="function"><span class="keyword">function</span>(<span class="params">err,data</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(err)&#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">&quot;5&quot;</span>)</span><br><span class="line">            <span class="comment">//pending变成rejected</span></span><br><span class="line">            reject(err)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">&quot;6&quot;</span>)</span><br><span class="line">            <span class="comment">//resolve实际上就是then方法传递的那个function</span></span><br><span class="line">            resolve(data)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;)</span><br><span class="line">p1.then(<span class="function"><span class="keyword">function</span>(<span class="params">data</span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(data)</span><br><span class="line">    <span class="keyword">return</span> <span class="number">123</span></span><br><span class="line"></span><br><span class="line">&#125;).then(<span class="function"><span class="keyword">function</span>(<span class="params">data</span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(data)</span><br><span class="line">&#125;)</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&quot;7&quot;</span>)</span><br><span class="line"></span><br><span class="line">结果：</span><br><span class="line"><span class="number">1</span></span><br><span class="line"><span class="number">2</span></span><br><span class="line"><span class="number">2</span></span><br><span class="line"><span class="number">7</span></span><br><span class="line"><span class="number">4</span></span><br><span class="line">爱你</span><br><span class="line"><span class="number">123</span></span><br><span class="line"><span class="number">6</span></span><br></pre></td></tr></table></figure>

<p>当return一个promise对象时，then的第一个参数是p2的resolve</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> fs=<span class="built_in">require</span>(<span class="string">&quot;fs&quot;</span>);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&quot;1&quot;</span>)</span><br><span class="line"><span class="keyword">var</span> p1=<span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve, reject</span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;2&quot;</span>)</span><br><span class="line">    fs.readFile(<span class="string">&#x27;F:\\nodejs\\code\\a.txt&#x27;</span>,<span class="string">&#x27;utf8&#x27;</span>,<span class="function"><span class="keyword">function</span>(<span class="params">err,data</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(err)&#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">&quot;3&quot;</span>)</span><br><span class="line">            <span class="comment">//pending变成rejected</span></span><br><span class="line">            reject(err)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">&quot;4&quot;</span>)</span><br><span class="line">            <span class="comment">//resolve实际上就是then方法传递的那个function</span></span><br><span class="line">            resolve(data)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> p2=<span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve, reject</span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;2&quot;</span>)</span><br><span class="line">    fs.readFile(<span class="string">&#x27;F:\\nodejs\\code\\b.txt&#x27;</span>,<span class="string">&#x27;utf8&#x27;</span>,<span class="function"><span class="keyword">function</span>(<span class="params">err,data</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(err)&#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">&quot;5&quot;</span>)</span><br><span class="line">            <span class="comment">//pending变成rejected</span></span><br><span class="line">            reject(err)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">&quot;6&quot;</span>)</span><br><span class="line">            <span class="comment">//resolve实际上就是then方法传递的那个function</span></span><br><span class="line">            resolve(data)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;)</span><br><span class="line">p1.then(<span class="function"><span class="keyword">function</span>(<span class="params">data</span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(data)</span><br><span class="line">    <span class="keyword">return</span> p2</span><br><span class="line"></span><br><span class="line">&#125;).then(<span class="function"><span class="keyword">function</span>(<span class="params">data</span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(data)</span><br><span class="line">&#125;)</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&quot;7&quot;</span>)</span><br><span class="line"></span><br><span class="line">结果:</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="使用promise模拟jquery中ajax"><a href="#使用promise模拟jquery中ajax" class="headerlink" title="使用promise模拟jquery中ajax"></a>使用promise模拟jquery中ajax</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">myAjax</span>(<span class="params">type,url,params</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolved,rejected</span>)=&gt;</span>&#123;</span><br><span class="line">            <span class="comment">//创建ajax对象</span></span><br><span class="line">            <span class="keyword">let</span> ajax;</span><br><span class="line">            <span class="comment">//注意，不要根据浏览器的navigator.userAgent来检测浏览器是否支持某个JavaScript特性，一是因为这个字符串本身可以伪造，二是通过IE版本判断JavaScript特性将非常复杂。</span></span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">window</span>.XMLHttpRequest) &#123;</span><br><span class="line">                ajax = <span class="keyword">new</span> XMLHttpRequest();</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                ajax = <span class="keyword">new</span> ActiveXObject(<span class="string">&#x27;Microsoft.XMLHTTP&#x27;</span>);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span>(type == <span class="string">&#x27;get&#x27;</span> || type == <span class="string">&#x27;&#x27;</span>)&#123;<span class="comment">//get</span></span><br><span class="line">                <span class="comment">//配置参数</span></span><br><span class="line">                ajax.open(<span class="string">&#x27;get&#x27;</span>,url,<span class="literal">true</span>)</span><br><span class="line">                <span class="comment">//发送请求</span></span><br><span class="line">                ajax.send();</span><br><span class="line">            &#125;<span class="keyword">else</span> <span class="keyword">if</span>(type == <span class="string">&#x27;post&#x27;</span>)&#123;<span class="comment">//post</span></span><br><span class="line">                <span class="comment">//配置参数</span></span><br><span class="line">                ajax.open(<span class="string">&#x27;post&#x27;</span>,url,<span class="literal">true</span>);</span><br><span class="line">                <span class="comment">//设置请求头，表示我传递的参数的类型</span></span><br><span class="line">                xhr.setRequestHeader(<span class="string">&quot;Content-type&quot;</span>, <span class="string">&quot;application/x-www-form-urlencoded&quot;</span>);</span><br><span class="line">                <span class="comment">//发送请求，并将数据传递过去</span></span><br><span class="line">                ajax.send(<span class="built_in">JSON</span>.stringify(data));</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">//请求成功之后</span></span><br><span class="line">            request.onreadystatechange = <span class="function"><span class="keyword">function</span> (<span class="params"></span>)</span>&#123;</span><br><span class="line">                <span class="keyword">if</span> (request.readyState === <span class="number">4</span>)&#123;</span><br><span class="line">                    <span class="keyword">if</span>(<span class="built_in">this</span>.status === <span class="number">200</span>)&#123;</span><br><span class="line">                        <span class="built_in">console</span>.log(ajax.responseText)</span><br><span class="line">                        resolved(ajax.responseText);</span><br><span class="line">                    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                        rejected();</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>调用</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">getAjax(<span class="string">&#x27;get&#x27;</span>).then().catch()</span><br><span class="line">getAjax(<span class="string">&#x27;post&#x27;</span>,param).then().catch()</span><br></pre></td></tr></table></figure>

<h3 id="jQuery中的promise"><a href="#jQuery中的promise" class="headerlink" title="jQuery中的promise"></a>jQuery中的promise</h3><p>jQuery中deferred对象相当于promise</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">    <span class="keyword">var</span> defer = $.Deferred();</span><br><span class="line">    <span class="built_in">console</span>.log(defer);</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p><img src="https://s2.loli.net/2022/01/07/LVWZAeEPQIi5aTN.png" alt="img"></p>
<p>用法</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">runAsync</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">var</span> defer = $.Deferred();</span><br><span class="line">        <span class="comment">//做一些异步操作</span></span><br><span class="line">        <span class="built_in">setTimeout</span>(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">&#x27;执行完成&#x27;</span>);</span><br><span class="line">            defer.resolve(<span class="string">&#x27;异步请求成功之后返回的数据&#x27;</span>);</span><br><span class="line">        &#125;, <span class="number">1000</span>);</span><br><span class="line">        <span class="keyword">return</span> defer;</span><br><span class="line">    &#125;</span><br><span class="line">    runAsync().then(<span class="function"><span class="keyword">function</span>(<span class="params">data</span>)</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(data)</span><br><span class="line">    &#125;);</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p>ES6中的promise</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">runAsync</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">var</span> p = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve, reject</span>)</span>&#123;</span><br><span class="line">           </span><br><span class="line">            <span class="built_in">setTimeout</span>(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">                <span class="built_in">console</span>.log(<span class="string">&#x27;执行完成&#x27;</span>);</span><br><span class="line">                resolve(<span class="string">&#x27;异步请求成功之后返回的数据&#x27;</span>);</span><br><span class="line">            &#125;, <span class="number">1000</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="keyword">return</span> p;            </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    runAsync().then(<span class="function"><span class="keyword">function</span>(<span class="params">data</span>)</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(data);</span><br><span class="line">    &#125;);</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p>先前了解了ES6的Promise对象，来看看jQuery中的Promise，也就是jQuery的Deferred对象。</p>
<p>打开浏览器的控制台先。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">    var defer = $.Deferred();</span><br><span class="line">    console.log(defer);</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p>运行代码</p>
<p>运行结果：</p>
<p><img src="https://images2017.cnblogs.com/blog/1235070/201709/1235070-20170928180504200-1631748545.png" alt="img"></p>
<p>和ES6的Promise对象长的有点像，jQuery的Deferred对象也有resolve、reject、then方法，还有done、fail、always……方法。jQuery就是用这个Deferred对象来注册异步操作的回调函数，修改并传递异步操作的状态。</p>
<p>玩玩Deferred：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">    function runAsync()&#123;</span><br><span class="line">        var defer = $.Deferred();</span><br><span class="line">        //做一些异步操作</span><br><span class="line">        setTimeout(function()&#123;</span><br><span class="line">            console.log(&#x27;执行完成&#x27;);</span><br><span class="line">            defer.resolve(&#x27;异步请求成功之后返回的数据&#x27;);</span><br><span class="line">        &#125;, 1000);</span><br><span class="line">        return defer;</span><br><span class="line">    &#125;</span><br><span class="line">    runAsync().then(function(data)&#123;</span><br><span class="line">        console.log(data)</span><br><span class="line">    &#125;);</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>



<p>运行代码</p>
<p> 运行之后，Deferred对象的实例defer通过resolve方法把参数 “异步请求成功之后返回的数据” 传回到then方法中进行接收，，打印。</p>
<p>和ES6的Promise相似，但是有一点点区别，再看下Promise：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">    function runAsync()&#123;</span><br><span class="line">        var p = new Promise(function(resolve, reject)&#123;</span><br><span class="line">           </span><br><span class="line">            setTimeout(function()&#123;</span><br><span class="line">                console.log(&#x27;执行完成&#x27;);</span><br><span class="line">                resolve(&#x27;异步请求成功之后返回的数据&#x27;);</span><br><span class="line">            &#125;, 1000);</span><br><span class="line">        &#125;);</span><br><span class="line">        return p;            </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    runAsync().then(function(data)&#123;</span><br><span class="line">        console.log(data);</span><br><span class="line">    &#125;);</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p>我们发现：</p>
<p>1、创建Deferred对象的时候没有传参；而创建Promise对象的时候，传了参数（传了一个匿名函数，函数也有两个参数：resolve、reject）；</p>
<p>2、Deferred对象直接调用了resolve方法；而Promise对象则是在内部调用的resolve方法；</p>
<p>说明：Deferred对象本身就有resolve方法，而Promise对象是在构造器中通过执行resolve方法，给Promise对象赋上了执行结果的状态。</p>
<p>这样就有一个弊端：因为Deferred对象自带resolve方法，拿到Deferred对象之后，就可以随时调用resolve方法，其状态可以进行手动干预了，这样不好</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">runAsync</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">var</span> defer = $.Deferred();</span><br><span class="line">        <span class="comment">//做一些异步操作</span></span><br><span class="line">        <span class="built_in">setTimeout</span>(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">&#x27;执行完成&#x27;</span>);</span><br><span class="line">            defer.resolve(<span class="string">&#x27;异步请求成功之后返回的数据&#x27;</span>);</span><br><span class="line">        &#125;, <span class="number">1000</span>);</span><br><span class="line">        <span class="keyword">return</span> defer;</span><br><span class="line">    &#125;</span><br><span class="line">　　 <span class="keyword">var</span> der = runAsync();</span><br><span class="line">　 　der.then(<span class="function"><span class="keyword">function</span>(<span class="params">data</span>)</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(data)</span><br><span class="line">　 　&#125;);</span><br><span class="line"> 　　der.resolve(<span class="string">&#x27;在外部结束&#x27;</span>); </span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p>这样的话就直接在外部直接给Deferred设置了状态，打印“在外部结束”，1s后打印“执行完成”，不会打印“异步请求成功之后返回的数据”了。</p>
<p>显然，这不好。我发个异步请求，还没收到数据就让人在外部给我结束了。。。。。。。</p>
<p>当然这个坑jQuery肯定会填的，在Deferred对象上有一个promise方法，是一个受限的Deferred对象</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">runAsync</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">var</span> def = $.Deferred();</span><br><span class="line">        <span class="comment">//做一些异步操作</span></span><br><span class="line">        <span class="built_in">setTimeout</span>(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">&#x27;执行完成&#x27;</span>);</span><br><span class="line">            def.resolve(<span class="string">&#x27;请求成功之后返回的数据&#x27;</span>);</span><br><span class="line">        &#125;, <span class="number">2000</span>);</span><br><span class="line">        <span class="keyword">return</span> def.promise(); <span class="comment">//就在这里调用</span></span><br><span class="line">    &#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p>所谓受限的Deferred对象，就是没有resolve和reject方法的Deferred对象。这样就无法在外边改变Deferred对象的状态了。</p>
<p><strong>then方法</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">runAsync</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">var</span> def = $.Deferred();</span><br><span class="line">        <span class="comment">//做一些异步操作</span></span><br><span class="line">        <span class="built_in">setTimeout</span>(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">              <span class="keyword">var</span> num = <span class="built_in">Math</span>.ceil(<span class="built_in">Math</span>.random()*<span class="number">10</span>); <span class="comment">//生成1-10的随机数</span></span><br><span class="line">               <span class="keyword">if</span>(num&lt;=<span class="number">5</span>)&#123;</span><br><span class="line">                   def.resolve(num);</span><br><span class="line">               &#125;</span><br><span class="line">               <span class="keyword">else</span>&#123;</span><br><span class="line">                   def.reject(<span class="string">&#x27;数字太大了&#x27;</span>);</span><br><span class="line">               &#125;</span><br><span class="line">        &#125;, <span class="number">2000</span>);</span><br><span class="line">        <span class="keyword">return</span> def.promise(); <span class="comment">//就在这里调用</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    runAsync().then(<span class="function"><span class="keyword">function</span>(<span class="params">d</span>)</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&quot;resolve&quot;</span>);</span><br><span class="line">        <span class="built_in">console</span>.log(d);</span><br><span class="line">    &#125;,<span class="function"><span class="keyword">function</span>(<span class="params">d</span>)</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&quot;reject&quot;</span>);</span><br><span class="line">        <span class="built_in">console</span>.log(d);</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p><strong>done，fail语法糖</strong>,分别用来指定执行完成和执行失败的回调,与这段代码是等价的：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">runAsync</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">var</span> def = $.Deferred();</span><br><span class="line">        <span class="comment">//做一些异步操作</span></span><br><span class="line">        <span class="built_in">setTimeout</span>(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">              <span class="keyword">var</span> num = <span class="built_in">Math</span>.ceil(<span class="built_in">Math</span>.random()*<span class="number">10</span>); <span class="comment">//生成1-10的随机数</span></span><br><span class="line">               <span class="keyword">if</span>(num&lt;=<span class="number">5</span>)&#123;</span><br><span class="line">                   def.resolve(num);</span><br><span class="line">               &#125;</span><br><span class="line">               <span class="keyword">else</span>&#123;</span><br><span class="line">                   def.reject(<span class="string">&#x27;数字太大了&#x27;</span>);</span><br><span class="line">               &#125;</span><br><span class="line">        &#125;, <span class="number">2000</span>);</span><br><span class="line">        <span class="keyword">return</span> def.promise(); <span class="comment">//就在这里调用</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    runAsync().done(<span class="function"><span class="keyword">function</span>(<span class="params">d</span>)</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&quot;resolve&quot;</span>);</span><br><span class="line">        <span class="built_in">console</span>.log(d);</span><br><span class="line">    &#125;).fail(<span class="function"><span class="keyword">function</span>(<span class="params">d</span>)</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&quot;reject&quot;</span>);</span><br><span class="line">        <span class="built_in">console</span>.log(d);</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p>always的用法</p>
<p>jquery的Deferred对象上还有一个always方法，不论执行完成还是执行失败，always都会执行，有点类似ajax中的complete。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">runAsync</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">       <span class="keyword">var</span> def = $.Deferred();</span><br><span class="line">       <span class="comment">//做一些异步操作</span></span><br><span class="line">       <span class="built_in">setTimeout</span>(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">             <span class="keyword">var</span> num = <span class="built_in">Math</span>.ceil(<span class="built_in">Math</span>.random()*<span class="number">10</span>); <span class="comment">//生成1-10的随机数</span></span><br><span class="line">             def.resolve(num);   </span><br><span class="line">       &#125;, <span class="number">2000</span>);</span><br><span class="line">       <span class="keyword">return</span> def.promise(); <span class="comment">//就在这里调用</span></span><br><span class="line">   &#125;</span><br><span class="line">   $.when(runAsync(), runAsync(), runAsync()) .then(<span class="function"><span class="keyword">function</span>(<span class="params">data1, data2, data3</span>)</span>&#123;</span><br><span class="line">　　　　 <span class="built_in">console</span>.log(<span class="string">&#x27;全部执行完成&#x27;</span>);</span><br><span class="line">　　　　 <span class="built_in">console</span>.log(data1, data2, data3);</span><br><span class="line">　　&#125;);</span><br></pre></td></tr></table></figure>

<p>﻿# Node.js 第6天课堂笔记</p>
<h2 id="知识点-4"><a href="#知识点-4" class="headerlink" title="知识点"></a>知识点</h2><ul>
<li>多人社区案例</li>
</ul>
<h2 id="反馈-4"><a href="#反馈-4" class="headerlink" title="反馈"></a>反馈</h2><h2 id="复习-4"><a href="#复习-4" class="headerlink" title="复习"></a>复习</h2><ul>
<li>MongoDB 数据库<ul>
<li>灵活</li>
<li>不用设计数据表</li>
<li>业务的改动不需要关心数据表结构</li>
<li>DBA 架构师 级别的工程师都需要掌握这项技能<ul>
<li>设计</li>
<li>维护</li>
<li>分布式计算</li>
</ul>
</li>
</ul>
</li>
<li>mongoose<ul>
<li>mongodb 官方包也可以操作 MongoDB 数据库</li>
<li>第三方包：WordPress 项目开发团队</li>
<li>设计 Schema</li>
<li>发布 Model（得到模型构造函数）<ul>
<li>查询</li>
<li>增加</li>
<li>修改</li>
<li>删除</li>
</ul>
</li>
</ul>
</li>
<li>Promise<ul>
<li><a target="_blank" rel="noopener" href="http://es6.ruanyifeng.com/#docs/promise">http://es6.ruanyifeng.com/#docs/promise</a></li>
<li>callback hell 回调地狱</li>
<li>回调函数中套了回调函数</li>
<li>Promise(EcmaScript 6 中新增了一个语法 API)</li>
<li>容器<ul>
<li>异步任务（pending）</li>
<li>resolve</li>
<li>reject</li>
</ul>
</li>
<li>then 方法获取容器的结果（成功的，失败的）</li>
<li>then 方法支持链式调用</li>
<li>可以在 then 方法中返回一个 promise 对象，然后在后面的 then 方法中获取上一个 then 返回的 promise 对象的状态结果</li>
</ul>
</li>
</ul>
<h2 id="上午总结-5"><a href="#上午总结-5" class="headerlink" title="上午总结"></a>上午总结</h2><h2 id="下午总结-4"><a href="#下午总结-4" class="headerlink" title="下午总结"></a>下午总结</h2><h2 id="总结-1"><a href="#总结-1" class="headerlink" title="总结"></a>总结</h2><ul>
<li><p>path 模块</p>
<ul>
<li><p>path.parse</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">path.parse(<span class="string">&#x27;C:\\path\\dir\\file.txt&#x27;</span>);</span><br><span class="line"><span class="comment">// 返回:</span></span><br><span class="line"><span class="comment">// &#123; root: &#x27;C:\\&#x27;,</span></span><br><span class="line"><span class="comment">//   dir: &#x27;C:\\path\\dir&#x27;,</span></span><br><span class="line"><span class="comment">//   base: &#x27;file.txt&#x27;,</span></span><br><span class="line"><span class="comment">//   ext: &#x27;.txt&#x27;,</span></span><br><span class="line"><span class="comment">//   name: &#x27;file&#x27; &#125;</span></span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>__dirname 和 __filename</p>
<ul>
<li><strong>动态的</strong> 获取当前文件或者文件所处目录的绝对路径</li>
<li>用来解决文件操作路劲的相对路径问题</li>
<li>因为在文件操作中，相对路径相对于执行 <code>node</code> 命令所处的目录</li>
<li>所以为了尽量避免这个问题，都建议文件操作的相对路劲都转为：<strong>动态的绝对路径</strong></li>
<li>方式：<code>path.join(__dirname, &#39;文件名&#39;)</code></li>
<li><code>__dirname</code>可以用来获取当前文件模块所属目录的绝对路径</li>
<li><code>__filename</code>可以用来获取当前文件的绝对路径</li>
</ul>
</li>
<li><p>art-template 模板引擎(include、block、extend)</p>
<ul>
<li><p>include</p>
<p>公共的头部，尾部</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;include <span class="string">&#x27;./header.art&#x27;</span>&#125;&#125;</span><br><span class="line">&#123;&#123;include <span class="string">&#x27;./header.art&#x27;</span> data&#125;&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>extend</p>
<p>index.html</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;extend <span class="string">&#x27;./layout.html&#x27;</span>&#125;&#125;</span><br><span class="line">&#123;&#123;block <span class="string">&#x27;content&#x27;</span>&#125;&#125;</span><br><span class="line">&lt;h1&gt;</span><br><span class="line">    填坑</span><br><span class="line">&lt;/h1&gt;</span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">h2</span>&gt;</span></span></span><br><span class="line"><span class="xml">	tianh</span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line">&#123;&#123;/block&#125;&#125;</span><br></pre></td></tr></table></figure>

<p>layout.html</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang=&quot;en&quot;&gt;</span><br><span class="line"></span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta charset=&quot;UTF-8&quot;&gt;</span><br><span class="line">    &lt;meta http-equiv=&quot;X-UA-Compatible&quot; content=&quot;IE=edge&quot;&gt;</span><br><span class="line">    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;</span><br><span class="line">    &lt;title&gt;Document&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line"></span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &#123;&#123; include &#x27;./header.html&#x27;&#125;&#125;</span><br><span class="line">    &lt;h1&gt;HELLO&#123;&#123;name&#125;&#125;&lt;/h1&gt;</span><br><span class="line"></span><br><span class="line">    &#123;&#123;block &#x27;content&#x27;&#125;&#125;</span><br><span class="line">    &lt;h1&gt;默认内容&lt;/h1&gt;</span><br><span class="line">    &lt;h2&gt;默认内容&lt;/h2&gt;</span><br><span class="line">    &lt;h1&gt;默认内容&lt;/h1&gt;</span><br><span class="line">    &#123;&#123;/block&#125;&#125;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line"></span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<p>注意填坑不是按照layout.html写坑的顺序，而是按照index中extend的调用顺序，并且相同标签只能填一个坑</p>
</li>
<li><p>block</p>
</li>
</ul>
</li>
<li><p>表单同步提交和异步提交区别</p>
<ul>
<li>以前没有 ajax 都是这么干的，甚至有些直接就是渲染了提示信息出来了</li>
<li>异步提交页面不会刷新，交互方式更灵活</li>
</ul>
</li>
<li><p>Express 中配置使用 express-session 插件</p>
</li>
<li><p>概述案例中注册-登陆-退出的前后端交互实现流程</p>
</li>
</ul>
<h2 id="目标-1"><a href="#目标-1" class="headerlink" title="目标"></a>目标</h2><h1 id="Node-js-第7天课堂笔记"><a href="#Node-js-第7天课堂笔记" class="headerlink" title="Node.js 第7天课堂笔记"></a>Node.js 第7天课堂笔记</h1><h2 id="知识点-5"><a href="#知识点-5" class="headerlink" title="知识点"></a>知识点</h2><ul>
<li>上午<ul>
<li>多人社区案例</li>
<li>Express 中间件</li>
</ul>
</li>
<li>下午<ul>
<li>Vue</li>
</ul>
</li>
</ul>
<hr>
<h2 id="反馈-5"><a href="#反馈-5" class="headerlink" title="反馈"></a>反馈</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">funtion extend (source, target) &#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> key <span class="keyword">in</span> source) &#123;</span><br><span class="line">    target[key] = source[key]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> obj1 = &#123;</span><br><span class="line">  <span class="attr">foo</span>: <span class="string">&#x27;bar&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> obj2 = &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&#x27;Jack&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// obj2 就拥有了 obj1 的所有成员了</span></span><br><span class="line">extend(obj1, obj2)</span><br></pre></td></tr></table></figure>

<ul>
<li> 唉…………</li>
<li> 老师我想问下 那个操作文件路径不受打开命令执行node命令所属路径影响什么意思，是可以在任意窗口打开都可以访问到吗。。。。。</li>
<li> 慢点 心急吃不了热豆腐</li>
<li> 老师讲的很好 很清晰 希望老师下午第一节上课时间短点 第一节很困 上课时间太长听课效率有点低</li>
<li> 老师 写案例的时候 一个文件的代码量多了 可不可以把字体稍微调小点便于看全局结构 有时候感觉自己连不上</li>
<li>extend还不是很理解<ul>
<li>模板继承</li>
<li>extend 把复制过来</li>
<li>layout</li>
<li>index （extend layout）</li>
<li>index 就具有了 layout 的内容</li>
<li>index 还可以有自己的自定义内容</li>
</ul>
</li>
<li> 能不能把命令系统地罗列一下,@ 0 @</li>
<li> 听得时候都差不多听懂了，可是自己做的时候发现不知道从何入手，即使是看着老师的需求与代码，也根本不懂怎么写了，感觉自己听完了就全都忘光了，很郁闷！</li>
<li>我现在学习的感觉就像 你是个俄国人，教我了一句外语，你已经重复 了很多遍，我也努力再听，但是当你说完的那一刻，我就完全不知道你说了什么。就是仅仅过了一耳朵，再加上内容太多，我已经感觉完全跟不上了，怎么办，我有点崩溃。怎么破<ul>
<li>上帝撒了一把智慧，可惜我打了一把伞</li>
<li>多花时间、废寝忘食</li>
</ul>
</li>
<li>老师你是不是喜欢Anglebaby?我同桌问的，她是个女的<ul>
<li>Angelababy</li>
</ul>
</li>
<li>如何在浏览器中模拟所谓的art-template高级技术？关于浏览器操作cookie的插件如何使用，需要注意些什么？还可以安装一些什么谷歌浏览器插件，有助于提高开发效率或模拟项目、测试的实用插件！<ul>
<li>只是一个工具</li>
<li><a target="_blank" rel="noopener" href="https://github.com/js-cookie/js-cookie">https://github.com/js-cookie/js-cookie</a></li>
<li>EditThisCookie Chrome 浏览器插件</li>
</ul>
</li>
<li>文件引入有规则吗，像router.js中，需要重新引入第三方模块express，但是body-parser在routre页面也使用了呀，但是怎么不用引入<ul>
<li> 这主要是中间件的原因</li>
</ul>
</li>
<li>req.session对象不清楚 希望老师再讲讲<ul>
<li>req.session.xxx = xxx</li>
<li>req.session.xxx</li>
<li>Session 是基于 Cookie 实现的</li>
</ul>
</li>
<li> session 那块还是不怎么明白</li>
<li> 课间下课尽量要准时，特别是上午第一节课比较困，听课效率低，反正下课次数固定，也不会让上课时间减少。 下午5点半增加上课时间多多益善</li>
<li> 思路有点乱，有些小地方不明确，总的来说练得太少</li>
<li>mongoose中的Schema用的不熟练<ul>
<li>多写写</li>
</ul>
</li>
<li>如果先启动node服务，再开启数据库，数据库服务开启了，但是数据库并没有连接，这样会出现所有的操作都会失效的情况，必须打开新的命令行使用mongo命令手动连接数据库 反过来，如果先开启数据库，再开启node服务，就不会出现这样的问题，因为user.js代码中mongoose.connect(‘mongodb://localhost/test’, { useMongoClient: true })自动连接了数据库，刚开始以为数据库竟然和node产生了依赖，原来并不是！ 希望老师控制每节课的上课时间，一节课集中精力的时间最多20分钟，接下来的20分钟基本只有一半的效率，后面的时间效率只会指数减小，所以希望老师能在45分钟左右就休息一次，也能提高效率； 老师讲的很细，很认真，也很负责，希望能在最后一个月的时间学好最重要的内容，就像你说的，因为刚好遇见你！<ul>
<li> 你说的对，加油。</li>
</ul>
</li>
<li> 一到数据库就蒙。数据库始终连接不上去。我觉得不知道我数据库都学了什么?_?</li>
<li> nice！</li>
</ul>
<hr>
<h2 id="复习-5"><a href="#复习-5" class="headerlink" title="复习"></a>复习</h2><ul>
<li>path 模块</li>
<li>__dirname 和 __filename<ul>
<li><strong>动态的</strong> 获取当前文件或者文件所处目录的绝对路径</li>
<li>用来解决文件操作路劲的相对路径问题</li>
<li>因为在文件操作中，相对路径相对于执行 <code>node</code> 命令所处的目录</li>
<li>所以为了尽量避免这个问题，都建议文件操作的相对路劲都转为：<strong>动态的绝对路径</strong></li>
<li>方式：<code>path.join(__dirname, &#39;文件名&#39;)</code></li>
</ul>
</li>
<li>art-template 模板引擎(include、block、extend)<ul>
<li>include</li>
<li>extend</li>
<li>block</li>
<li>动手写一写</li>
</ul>
</li>
<li>表单同步提交和异步提交区别<ul>
<li>字符串交互</li>
<li>请求（报文、具有一定格式的字符串）</li>
<li>HTTP 就是 Web 中的沟通语言</li>
<li>服务器响应（字符串）</li>
<li>01</li>
<li>服务器端重定向针对异步请求无效</li>
</ul>
</li>
</ul>
<h3 id="session"><a href="#session" class="headerlink" title="session"></a>session</h3><h4 id="session的简介"><a href="#session的简介" class="headerlink" title="session的简介"></a>session的简介</h4><p>session是另一中记录客户状态的机制，与cookie不同的是 session数据保存在服务器中，而不是保存在客户端浏览器中，。</p>
<h4 id="session的用途"><a href="#session的用途" class="headerlink" title="session的用途"></a>session的用途</h4><p>session运行在服务器端，当客户端第一次访问服务器时，可以将客户的登录信息保存在服务器端。</p>
<p>当用户访问站点的其他页面时，可以根据用户的登录状态做出相应的提示，身份验证拦截。</p>
<p>session可以和数据库结合做持久化操作，当服务器挂掉时，不会导致用户信息丢失。</p>
<h4 id="session的工作流程"><a href="#session的工作流程" class="headerlink" title="session的工作流程"></a>session的工作流程</h4><p>当客户端第一次请求服务器时，服务器会为每个客户端创建一个独享的session对象，用于跟踪用户的状态。<br>同时，为session对象分配一个唯一标识sessionId。<br>为了管理session对象，以sessionId为键，以session对象为值，封装成Map集合。<br>响应客户端时，将sessionId以cookie的形式发送给客户端，存放在客户端浏览器的缓存中。<br>当客户端再次请求服务器时，会将sessionId以cookie请求头的方式发送给服务器，服务器得到sessionId后，从Map集合中，得到session对象，从而跟踪状态。</p>
<p><img src="https://s2.loli.net/2022/01/11/ILGFCsPMVa7pOQT.png" alt="在这里插入图片描述"></p>
<h4 id="session的特点"><a href="#session的特点" class="headerlink" title="session的特点"></a>session的特点</h4><p>同源的页面之间可以共享session数据<br>浏览器关闭时，服务器中保存的session对象也会跟着销毁<br>在第一次调用request.getSession()方法时，创建出session，<br>超时：session超过一定时间（默认30分钟，这个时间可设置）没有人使用，则认为超时，干掉这个session。<br>自杀：也可以明确的调用session的invalidate()方法，手动的杀死session。<br>意外身亡：或者当服务器非正常关闭时，服务器中的session跟着消亡。</p>
<ul>
<li><p>Express 中配置使用 express-session 插件</p>
<ul>
<li>插件也是工具</li>
<li>你只需要明确你的目标就可以了</li>
<li>我们最终的目标就是使用 Session 来帮我们管理一些敏感信息数据状态，例如保存登陆状态</li>
<li>写 Session<ul>
<li>req.session.xxx = xx</li>
</ul>
</li>
<li>读 Session<ul>
<li>req.session.xxx</li>
</ul>
</li>
<li>删除 Session<ul>
<li>req.session.xxx = null</li>
<li>更严谨的做法是 <code>delete</code> 语法</li>
<li>delete req.session.xxx</li>
</ul>
</li>
</ul>
</li>
<li><p>概述案例中注册-登陆-退出的前后端交互实现流程</p>
</li>
<li><p>session配置项</p>
<p>1.安装</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install express-session</span><br></pre></td></tr></table></figure>

<p>2.加载</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> session = <span class="built_in">require</span>(<span class="string">&#x27;express-session&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>3.使用</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 配置中间件</span></span><br><span class="line">app.use(session(&#123;</span><br><span class="line">  <span class="attr">secret</span>: <span class="string">&#x27;keyboard cat&#x27;</span>,</span><br><span class="line">  <span class="attr">resave</span>: <span class="literal">false</span>,</span><br><span class="line">  <span class="attr">saveUninitialized</span>: <span class="literal">true</span>,</span><br><span class="line">  <span class="comment">// cookie: &#123; secure: true &#125; // https 协议的请求才会传入 cookie </span></span><br><span class="line">&#125;))</span><br><span class="line"></span><br><span class="line">req.session.userinfo = <span class="string">&#x27;zhangsan&#x27;</span>;</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>secret</td>
<td>字符串，作为服务端生成session的签名</td>
</tr>
<tr>
<td>name</td>
<td>返回客户端的cookie的名称，默认为content.sid，也可以自己设置</td>
</tr>
<tr>
<td>resave</td>
<td>强制重新保存session，即使它没有变化，默认为true，建议设置成false</td>
</tr>
<tr>
<td>saveUninitialized</td>
<td>强制将未初始化的session存储，默认是true，建议设置成true,不管是不是用session都默认分配一把钥匙</td>
</tr>
<tr>
<td>cookie</td>
<td>关于cookie配置信息</td>
</tr>
<tr>
<td>rolling</td>
<td>在每次请求时强行设置cookie，这将重置cookie过期时间，默认值为false</td>
</tr>
</tbody></table>
<p>默认session数据是内存存储，服务器一旦重启就丢失，真正的生产环境是会把session持久化存储</p>
</li>
</ul>
<h3 id="中间件"><a href="#中间件" class="headerlink" title="中间件"></a>中间件</h3><h4 id="中间件的本质及工作原理"><a href="#中间件的本质及工作原理" class="headerlink" title="中间件的本质及工作原理"></a>中间件的本质及工作原理</h4><h5 id="中间件其实就是一个函数"><a href="#中间件其实就是一个函数" class="headerlink" title="中间件其实就是一个函数"></a>中间件其实就是一个函数</h5><p>function(req,res,next){ req:请求对象 res：响应对象 next：下一个中间件 }</p>
<h5 id="Express如何使用中间件-三种方式"><a href="#Express如何使用中间件-三种方式" class="headerlink" title="Express如何使用中间件?:三种方式"></a>Express如何使用中间件?:三种方式</h5><p> app.use(‘pathname’,中间件) : </p>
<p> pathname不写: 任何请求路径都会执行这个中间件  </p>
<p>pathname写了：任何以pathname开头的请求路径都会执行这个中间件  </p>
<p>app.get(‘pathname’,中间件) : 请求路径为pathname的get请求会执行这个中间件  app.post(‘pathname’,中间件) : 请求路径为pathname的post请求会执行这个中间件</p>
<h5 id="中间件工作流程（Express处理网络请求流程）"><a href="#中间件工作流程（Express处理网络请求流程）" class="headerlink" title="中间件工作流程（Express处理网络请求流程）"></a>中间件工作流程（Express处理网络请求流程）</h5><p><img src="https://s2.loli.net/2022/01/11/oGH1d9FSavhnjcL.png" alt="在这里插入图片描述"></p>
<p> <code>a.从上往下依次匹配请求路径，如果匹配成功则执行该中间件  b.如果这个中间件中调用了：next() ，则会继续往下匹配  c.如果所有的中间件都无法匹配，则会自动进入一个兜底的中间件响应返回404 not found错误</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//导入模块</span></span><br><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>);</span><br><span class="line"><span class="comment">//创建服务器</span></span><br><span class="line"><span class="keyword">let</span> app = express();</span><br><span class="line"></span><br><span class="line"><span class="comment">/*1.什么是express中间件？： 其实就是一个函数（这个函数有三个参数）</span></span><br><span class="line"><span class="comment">    function(req,res,next)&#123;  </span></span><br><span class="line"><span class="comment">        req:请求对象  </span></span><br><span class="line"><span class="comment">        res：响应对象  </span></span><br><span class="line"><span class="comment">        next：下一个中间件 </span></span><br><span class="line"><span class="comment">    &#125;</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*2.express如何使用中间件?: 三种方式  </span></span><br><span class="line"><span class="comment">    app.use(&#x27;pathname&#x27;,中间件) :</span></span><br><span class="line"><span class="comment">        pathname不写: 任何请求路径都会执行这个中间件</span></span><br><span class="line"><span class="comment">        pathname写了：任何以pathname开头的请求路径都会执行这个中间件</span></span><br><span class="line"><span class="comment">    app.get(&#x27;pathname&#x27;,中间件) :  请求路径为pathname的get请求会执行这个中间件</span></span><br><span class="line"><span class="comment">    app.post(&#x27;pathname&#x27;,中间件) :  请求路径为pathname的post请求会执行这个中间件</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* 3.express处理网络请求的流程</span></span><br><span class="line"><span class="comment">    a.从上往下依次匹配请求路径，如果匹配成功则执行该中间件</span></span><br><span class="line"><span class="comment">    b.如果这个中间件中调用了：next() ，则会继续往下匹配</span></span><br><span class="line"><span class="comment">    c.如果所有的中间件都无法匹配，则会自动进入一个兜底的中间件响应返回404 not found错误</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line">app.use(<span class="string">&#x27;/abc&#x27;</span>,<span class="function">(<span class="params">req,res,next</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="comment">//污水净化第一步：添加絮凝剂</span></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="number">11111</span>);</span><br><span class="line">    req.a = <span class="string">&#x27;添加了絮凝剂&#x27;</span>;</span><br><span class="line">    next();</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">app.use(<span class="string">&#x27;/abc&#x27;</span>,<span class="function">(<span class="params">req,res,next</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="comment">//污水净化第二步：添加活性炭</span></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="number">22222</span>);</span><br><span class="line">    req.b = <span class="string">&#x27;添加活性炭&#x27;</span>;</span><br><span class="line">    next();</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.post(<span class="string">&#x27;/abc&#x27;</span>,<span class="function">(<span class="params">req,res,next</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="number">33333</span>);</span><br><span class="line">    next();</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.get(<span class="string">&#x27;/abc&#x27;</span>,<span class="function">(<span class="params">req,res,next</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="number">44444</span>);</span><br><span class="line">    <span class="comment">//看下污水净化到这一步加了什么</span></span><br><span class="line">    <span class="built_in">console</span>.log(req.a);</span><br><span class="line">    <span class="built_in">console</span>.log(req.b);</span><br><span class="line">    res.send(<span class="string">&#x27;hello&#x27;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//express底层有一个默认的兜底中间件，如果上面所有的中间件都无法匹配或者没有结束响应，则会进入这个中间件</span></span><br><span class="line"><span class="comment">//自定义一个兜底中间件，覆盖默认的</span></span><br><span class="line">app.use(<span class="function">(<span class="params">req,res</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="number">55555</span>);</span><br><span class="line">    </span><br><span class="line">    res.send(<span class="string">&#x27;你的路径是不是写错啦&#x27;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//开启服务器</span></span><br><span class="line">app.listen(<span class="number">3000</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;success&#x27;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h5 id="定义解析post请求参数中间件"><a href="#定义解析post请求参数中间件" class="headerlink" title="定义解析post请求参数中间件"></a>定义解析post请求参数中间件</h5><ul>
<li>bodyParse</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> querystring = <span class="built_in">require</span>(<span class="string">&#x27;querystring&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">/*  导出中间件(函数)</span></span><br><span class="line"><span class="comment">    第一个参数：请求对象</span></span><br><span class="line"><span class="comment">    第二个参数：完成回调</span></span><br><span class="line"><span class="comment">        * postObject:post请求参数对象</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="built_in">module</span>.exports = <span class="function">(<span class="params">req, res, next</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">/*如果本次请求是post请求，则解析post请求参数，</span></span><br><span class="line"><span class="comment">    并且将解析好的参数对象作为req的属性传递给下一个中间件*/</span></span><br><span class="line">    <span class="keyword">if</span> (req.method == <span class="string">&#x27;POST&#x27;</span>) &#123;</span><br><span class="line">        <span class="comment">//1.1 给req注册一个data事件</span></span><br><span class="line">        <span class="keyword">let</span> postData = <span class="string">&quot;&quot;</span>;</span><br><span class="line">        req.on(<span class="string">&#x27;data&#x27;</span>, <span class="function"><span class="keyword">function</span> (<span class="params">chuck</span>) </span>&#123;</span><br><span class="line">            postData += chuck;</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="comment">//1.2给req注册一个end事件</span></span><br><span class="line">        req.on(<span class="string">&#x27;end&#x27;</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="comment">//1.3 使用 querystring模块解析post参数</span></span><br><span class="line">            <span class="keyword">let</span> postObjc = querystring.parse(postData);</span><br><span class="line">            <span class="comment">//将解析好的参数对象添加到req的属性中</span></span><br><span class="line">            req.body = postObjc;</span><br><span class="line">            <span class="comment">//执行下一个中间件</span></span><br><span class="line">            next();</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li><p>index.js</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">//导入模块</span><br><span class="line">const express = require(&#x27;express&#x27;);</span><br><span class="line">//创建服务器</span><br><span class="line">let app = express();</span><br><span class="line"></span><br><span class="line">//使用中间件</span><br><span class="line">//任何请求都会进入我们自己写的中间件，并且只要是post请求就会帮你解析好参数放入req.body中</span><br><span class="line">app.use(require(&#x27;./bodyParse.js&#x27;));</span><br><span class="line"></span><br><span class="line">app.post(&#x27;/abc&#x27;,(req,res,next)=&gt;&#123;</span><br><span class="line">    console.log(req.body);</span><br><span class="line">    //告诉客户端我收到的参数</span><br><span class="line">    res.send(req.body);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.post(&#x27;/efg&#x27;,(req,res,next)=&gt;&#123;</span><br><span class="line">    console.log(req.body);</span><br><span class="line">    //告诉客户端我收到的参数</span><br><span class="line">    res.send(req.body);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">//开启服务器</span><br><span class="line">app.listen(3000, () =&gt; &#123;</span><br><span class="line">    console.log(&#x27;success&#x27;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ul>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">zengxiang</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://zengxiang21.github.io/2022/01/11/node/">https://zengxiang21.github.io/2022/01/11/node/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://zengxiang21.github.io" target="_blank">zx的博客</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"></div><div class="post_share"><div class="social-share" data-image="https://picsum.photos/id/369/4692/3128" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2022/01/12/vue/"><img class="prev-cover" src="https://picsum.photos/id/306/1024/768" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">Vue</div></div></a></div><div class="next-post pull-right"><a href="/2021/12/12/Ajax/"><img class="next-cover" src="https://picsum.photos/id/144/4912/2760" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">Ajax</div></div></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/./img/avatar.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">zengxiang</div><div class="author-info__description">zx的博客,欢迎访问</div></div><div class="card-info-data is-center"><div class="card-info-data-item"><a href="/archives/"><div class="headline">文章</div><div class="length-num">11</div></a></div><div class="card-info-data-item"><a href="/tags/"><div class="headline">标签</div><div class="length-num">0</div></a></div><div class="card-info-data-item"><a href="/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div></div><a class="button--animated" id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/zengxiang21" target="_blank" title="Github"><i class="fab fa-github"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn card-announcement-animation"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Node-js-%E7%AC%AC1%E5%A4%A9"><span class="toc-number">1.</span> <span class="toc-text">Node.js 第1天</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%8A%E5%8D%88%E6%80%BB%E7%BB%93"><span class="toc-number">1.1.</span> <span class="toc-text">上午总结</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%80%BB%E7%BB%93"><span class="toc-number">1.2.</span> <span class="toc-text">总结</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Node-js-%E7%AC%AC2%E5%A4%A9%E8%AF%BE%E5%A0%82%E7%AC%94%E8%AE%B0"><span class="toc-number">2.</span> <span class="toc-text">Node.js 第2天课堂笔记</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9"><span class="toc-number">2.1.</span> <span class="toc-text">知识点</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%8D%E9%A6%88"><span class="toc-number">2.2.</span> <span class="toc-text">反馈</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%A3%E7%A0%81%E9%A3%8E%E6%A0%BC"><span class="toc-number">2.2.1.</span> <span class="toc-text">代码风格</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A4%8D%E4%B9%A0"><span class="toc-number">2.3.</span> <span class="toc-text">复习</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%8A%E5%8D%88%E6%80%BB%E7%BB%93-1"><span class="toc-number">2.4.</span> <span class="toc-text">上午总结</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%8B%E5%8D%88%E6%80%BB%E7%BB%93"><span class="toc-number">2.5.</span> <span class="toc-text">下午总结</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9C%A8Node%E4%B8%AD%E4%BD%BF%E7%94%A8%E6%A8%A1%E6%9D%BF%E5%BC%95%E6%93%8E"><span class="toc-number">2.5.1.</span> <span class="toc-text">在Node中使用模板引擎</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8F%90%E4%BA%A4%E8%A1%A8%E5%8D%95"><span class="toc-number">2.5.2.</span> <span class="toc-text">提交表单</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%87%8D%E5%AE%9A%E5%90%91"><span class="toc-number">2.5.3.</span> <span class="toc-text">重定向</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Node-js-%E7%AC%AC3%E5%A4%A9%E8%AF%BE%E5%A0%82%E7%AC%94%E8%AE%B0"><span class="toc-number">3.</span> <span class="toc-text">Node.js 第3天课堂笔记</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9-1"><span class="toc-number">3.1.</span> <span class="toc-text">知识点</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%8D%E9%A6%88-1"><span class="toc-number">3.2.</span> <span class="toc-text">反馈</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A4%8D%E4%B9%A0-1"><span class="toc-number">3.3.</span> <span class="toc-text">复习</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%8A%E5%8D%88%E6%80%BB%E7%BB%93-2"><span class="toc-number">3.4.</span> <span class="toc-text">上午总结</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%8B%E5%8D%88%E6%80%BB%E7%BB%93-1"><span class="toc-number">3.5.</span> <span class="toc-text">下午总结</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Node-js-%E7%AC%AC4%E5%A4%A9%E8%AF%BE%E5%A0%82%E7%AC%94%E8%AE%B0"><span class="toc-number">4.</span> <span class="toc-text">Node.js 第4天课堂笔记</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9-2"><span class="toc-number">4.1.</span> <span class="toc-text">知识点</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%8D%E9%A6%88-2"><span class="toc-number">4.2.</span> <span class="toc-text">反馈</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A4%8D%E4%B9%A0-2"><span class="toc-number">4.3.</span> <span class="toc-text">复习</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A8%A1%E5%9D%97%E6%A0%87%E8%AF%86%E4%B8%AD%E7%9A%84-%E5%92%8C%E6%96%87%E4%BB%B6%E6%93%8D%E4%BD%9C%E8%B7%AF%E5%BE%84%E4%B8%AD%E7%9A%84"><span class="toc-number">4.3.1.</span> <span class="toc-text">模块标识中的 &#x2F; 和文件操作路径中的 &#x2F;</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%8A%E5%8D%88%E6%80%BB%E7%BB%93-3"><span class="toc-number">4.4.</span> <span class="toc-text">上午总结</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%BC%94%E8%AE%B2"><span class="toc-number">4.4.1.</span> <span class="toc-text">演讲</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%8B%E5%8D%88%E6%80%BB%E7%BB%93-2"><span class="toc-number">4.5.</span> <span class="toc-text">下午总结</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%9B%AE%E6%A0%87"><span class="toc-number">4.6.</span> <span class="toc-text">目标</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Node-js-%E7%AC%AC5%E5%A4%A9%E8%AF%BE%E5%A0%82%E7%AC%94%E8%AE%B0"><span class="toc-number">5.</span> <span class="toc-text">Node.js 第5天课堂笔记</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9-3"><span class="toc-number">5.1.</span> <span class="toc-text">知识点</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%8D%E9%A6%88-3"><span class="toc-number">5.2.</span> <span class="toc-text">反馈</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A4%8D%E4%B9%A0-3"><span class="toc-number">5.3.</span> <span class="toc-text">复习</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%8A%E5%8D%88%E6%80%BB%E7%BB%93-4"><span class="toc-number">5.4.</span> <span class="toc-text">上午总结</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#MongoDB"><span class="toc-number">5.4.1.</span> <span class="toc-text">MongoDB</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%85%B3%E7%B3%BB%E5%9E%8B%E6%95%B0%E6%8D%AE%E5%BA%93%E5%92%8C%E9%9D%9E%E5%85%B3%E7%B3%BB%E5%9E%8B%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-number">5.4.1.1.</span> <span class="toc-text">关系型数据库和非关系型数据库</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%90%AF%E5%8A%A8%E5%85%B3%E9%97%AD%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-number">5.4.1.2.</span> <span class="toc-text">启动关闭数据库</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%93%BE%E6%8E%A5%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-number">5.4.1.3.</span> <span class="toc-text">链接数据库</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B8%B8%E8%A7%81%E5%91%BD%E4%BB%A4"><span class="toc-number">5.4.1.4.</span> <span class="toc-text">常见命令</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#node%E4%B8%AD%E5%A6%82%E4%BD%95%E6%93%8D%E7%BA%B5MongoDB%E6%95%B0%E6%8D%AE"><span class="toc-number">5.4.1.5.</span> <span class="toc-text">node中如何操纵MongoDB数据</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E7%AC%AC%E4%B8%89%E6%96%B9mongoose%E6%9D%A5%E6%93%8D%E4%BD%9CMongoDB%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-number">5.4.1.6.</span> <span class="toc-text">使用第三方mongoose来操作MongoDB数据库</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MySQL"><span class="toc-number">5.4.2.</span> <span class="toc-text">MySQL</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%8B%E5%8D%88%E6%80%BB%E7%BB%93-3"><span class="toc-number">5.5.</span> <span class="toc-text">下午总结</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9B%9E%E8%B0%83%E5%9C%B0%E7%8B%B1callbackHell"><span class="toc-number">5.5.1.</span> <span class="toc-text">回调地狱callbackHell</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Promise%E5%AF%B9%E8%B1%A1%E7%89%B9%E7%82%B9"><span class="toc-number">5.5.2.</span> <span class="toc-text">Promise对象特点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#promise%E4%BC%98%E7%BC%BA%E7%82%B9"><span class="toc-number">5.5.3.</span> <span class="toc-text">promise优缺点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#promise%E5%88%9B%E5%BB%BA"><span class="toc-number">5.5.4.</span> <span class="toc-text">promise创建</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8promise%E6%A8%A1%E6%8B%9Fjquery%E4%B8%ADajax"><span class="toc-number">5.5.5.</span> <span class="toc-text">使用promise模拟jquery中ajax</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#jQuery%E4%B8%AD%E7%9A%84promise"><span class="toc-number">5.5.6.</span> <span class="toc-text">jQuery中的promise</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9-4"><span class="toc-number">5.6.</span> <span class="toc-text">知识点</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%8D%E9%A6%88-4"><span class="toc-number">5.7.</span> <span class="toc-text">反馈</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A4%8D%E4%B9%A0-4"><span class="toc-number">5.8.</span> <span class="toc-text">复习</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%8A%E5%8D%88%E6%80%BB%E7%BB%93-5"><span class="toc-number">5.9.</span> <span class="toc-text">上午总结</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%8B%E5%8D%88%E6%80%BB%E7%BB%93-4"><span class="toc-number">5.10.</span> <span class="toc-text">下午总结</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%80%BB%E7%BB%93-1"><span class="toc-number">5.11.</span> <span class="toc-text">总结</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%9B%AE%E6%A0%87-1"><span class="toc-number">5.12.</span> <span class="toc-text">目标</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Node-js-%E7%AC%AC7%E5%A4%A9%E8%AF%BE%E5%A0%82%E7%AC%94%E8%AE%B0"><span class="toc-number">6.</span> <span class="toc-text">Node.js 第7天课堂笔记</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9-5"><span class="toc-number">6.1.</span> <span class="toc-text">知识点</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%8D%E9%A6%88-5"><span class="toc-number">6.2.</span> <span class="toc-text">反馈</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A4%8D%E4%B9%A0-5"><span class="toc-number">6.3.</span> <span class="toc-text">复习</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#session"><span class="toc-number">6.3.1.</span> <span class="toc-text">session</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#session%E7%9A%84%E7%AE%80%E4%BB%8B"><span class="toc-number">6.3.1.1.</span> <span class="toc-text">session的简介</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#session%E7%9A%84%E7%94%A8%E9%80%94"><span class="toc-number">6.3.1.2.</span> <span class="toc-text">session的用途</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#session%E7%9A%84%E5%B7%A5%E4%BD%9C%E6%B5%81%E7%A8%8B"><span class="toc-number">6.3.1.3.</span> <span class="toc-text">session的工作流程</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#session%E7%9A%84%E7%89%B9%E7%82%B9"><span class="toc-number">6.3.1.4.</span> <span class="toc-text">session的特点</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%AD%E9%97%B4%E4%BB%B6"><span class="toc-number">6.3.2.</span> <span class="toc-text">中间件</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%AD%E9%97%B4%E4%BB%B6%E7%9A%84%E6%9C%AC%E8%B4%A8%E5%8F%8A%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86"><span class="toc-number">6.3.2.1.</span> <span class="toc-text">中间件的本质及工作原理</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%B8%AD%E9%97%B4%E4%BB%B6%E5%85%B6%E5%AE%9E%E5%B0%B1%E6%98%AF%E4%B8%80%E4%B8%AA%E5%87%BD%E6%95%B0"><span class="toc-number">6.3.2.1.1.</span> <span class="toc-text">中间件其实就是一个函数</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Express%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8%E4%B8%AD%E9%97%B4%E4%BB%B6-%E4%B8%89%E7%A7%8D%E6%96%B9%E5%BC%8F"><span class="toc-number">6.3.2.1.2.</span> <span class="toc-text">Express如何使用中间件?:三种方式</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%B8%AD%E9%97%B4%E4%BB%B6%E5%B7%A5%E4%BD%9C%E6%B5%81%E7%A8%8B%EF%BC%88Express%E5%A4%84%E7%90%86%E7%BD%91%E7%BB%9C%E8%AF%B7%E6%B1%82%E6%B5%81%E7%A8%8B%EF%BC%89"><span class="toc-number">6.3.2.1.3.</span> <span class="toc-text">中间件工作流程（Express处理网络请求流程）</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AE%9A%E4%B9%89%E8%A7%A3%E6%9E%90post%E8%AF%B7%E6%B1%82%E5%8F%82%E6%95%B0%E4%B8%AD%E9%97%B4%E4%BB%B6"><span class="toc-number">6.3.2.1.4.</span> <span class="toc-text">定义解析post请求参数中间件</span></a></li></ol></li></ol></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2022/03/24/objective-c/" title="Objective-C"><img src="https://picsum.photos/id/701/1858/1393" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Objective-C"/></a><div class="content"><a class="title" href="/2022/03/24/objective-c/" title="Objective-C">Objective-C</a><time datetime="2022-03-24T08:11:43.297Z" title="发表于 2022-03-24 16:11:43">2022-03-24</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/01/12/vue/" title="Vue"><img src="https://picsum.photos/id/306/1024/768" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Vue"/></a><div class="content"><a class="title" href="/2022/01/12/vue/" title="Vue">Vue</a><time datetime="2022-01-12T11:55:24.457Z" title="发表于 2022-01-12 19:55:24">2022-01-12</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/01/11/node/" title="Nodejs"><img src="https://picsum.photos/id/369/4692/3128" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Nodejs"/></a><div class="content"><a class="title" href="/2022/01/11/node/" title="Nodejs">Nodejs</a><time datetime="2022-01-11T12:42:19.228Z" title="发表于 2022-01-11 20:42:19">2022-01-11</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/12/12/Ajax/" title="Ajax"><img src="https://picsum.photos/id/144/4912/2760" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Ajax"/></a><div class="content"><a class="title" href="/2021/12/12/Ajax/" title="Ajax">Ajax</a><time datetime="2021-12-12T02:18:29.742Z" title="发表于 2021-12-12 10:18:29">2021-12-12</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/12/03/jQuery/" title="jQuery"><img src="https://picsum.photos/id/908/1920/1280" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="jQuery"/></a><div class="content"><a class="title" href="/2021/12/03/jQuery/" title="jQuery">jQuery</a><time datetime="2021-12-03T02:28:02.101Z" title="发表于 2021-12-03 10:28:02">2021-12-03</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2022 By zengxiang</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.js"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>